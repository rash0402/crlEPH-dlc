---

title: "Emergent Perceptual Haze (EPH)"
type: Research_Proposal
status: "ğŸŸ¢ Active Development"
version: 5.6.0
date_created: "2025-12-18"
date_modified: "2026-01-10"
author: "Hiroshi Igarashi"
institution: "Tokyo Denki University"
keywords:
  - Free Energy Principle
  - Active Inference
  - Surprise Minimization
  - Social Navigation
  - Uncertainty Modeling
  - Precision Control
  - Swarm Intelligence
  - Perceptual Precision
  - Uncertainty-Adaptive Control
tags:
  - Research/Proposal
  - Topic/FEP
  - Status/Active
changelog:
  - version: 5.6.1
    date: "2026-01-10"
    changes:
      - "VAEè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’Haze=0ï¼ˆæœ€é«˜è§£åƒåº¦ï¼‰SPMã«å¤‰æ›´"
      - "VAEã®å½¹å‰²ã‚’å†ç¢ºèªï¼šSPMäºˆæ¸¬ã¨Surpriseè¨ˆç®—ã®ã¿ï¼ˆHazeè¨ˆç®—ã¯è¡Œã‚ãªã„ï¼‰"
      - "å› æœãƒ•ãƒ­ãƒ¼ã®æ˜ç¢ºåŒ–ï¼šHazeï¼ˆè¨­è¨ˆè€…è¨­å®šï¼‰â†’ Î² â†’ SPMç”Ÿæˆ â†’ VAE"
  - version: 5.6.0
    date: "2026-01-10"
    changes:
      - "Surpriseé …ã‚’è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«çµ±åˆï¼ˆActive Inferenceæ•´åˆæ€§ç¢ºä¿ï¼‰"
      - "Hazeã‚’è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å†å®šç¾©ï¼ˆVAEè‡ªå‹•è¨ˆç®—ã‹ã‚‰åˆ†é›¢ï¼‰"
      - "VAEã®å½¹å‰²ã‚’äºˆæ¸¬+Surpriseè¨ˆç®—ã«æ˜ç¢ºåŒ–"
      - "Self-Hazingã‚’å°†æ¥æ‹¡å¼µã¨ã—ã¦è¿½åŠ "
---



# ç ”ç©¶ææ¡ˆæ›¸: Emergent Perceptual Haze (EPH)

> [!ABSTRACT] ææ¡ˆã®æ¦‚è¦ï¼ˆOne-Liner Pitchï¼‰
>
> ä¸ç¢ºå®Ÿæ€§ã‚’ **Surpriseï¼ˆäºˆæ¸¬å›°é›£åº¦ï¼‰** ã¨ **Hazeï¼ˆçŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰** ã®äºŒå±¤åˆ¶å¾¡ã¨ã—ã¦æ‰±ã† Active Inference ã®å·¥å­¦çš„å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ **EPH (Emergent Perceptual Haze)** ã‚’ææ¡ˆã™ã‚‹ã€‚æœ¬æ‰‹æ³•ã¯ã€Surpriseæœ€å°åŒ–ã«ã‚ˆã‚‹è¡Œå‹•é¸æŠã¨ã€Hazeã«ã‚ˆã‚‹çŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€å˜ä½“ãƒ­ãƒœãƒƒãƒˆãŠã‚ˆã³ç¾¤çŸ¥èƒ½ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹åœæ­¢ãƒ»æŒ¯å‹•ãƒ»åˆ†æ–­ã¨ã„ã£ãŸä¸ç¢ºå®Ÿæ€§èµ·å› ã®è¡Œå‹•ç ´ç¶»ã‚’æ§‹é€ çš„ã«æŠ‘åˆ¶ã™ã‚‹ã€‚


## è¦æ—¨ (Abstract)

### èƒŒæ™¯ (Background)

å…¬å…±ç©ºé–“ã‚„å¤šä¸»ä½“ç’°å¢ƒã«ãŠã‘ã‚‹è‡ªå¾‹ãƒ­ãƒœãƒƒãƒˆã®å®Ÿé‹ç”¨ã§ã¯ã€å®‰å…¨æ€§ã¨ç¤¾ä¼šçš„å—å®¹æ€§ã‚’ä¸¡ç«‹ã—ã¤ã¤ã€ä¸ç¢ºå®Ÿæ€§ã®é«˜ã„çŠ¶æ³ã«æŸ”è»Ÿã«é©å¿œã™ã‚‹èƒ½åŠ›ãŒä¸å¯æ¬ ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€æ··é›‘ç’°å¢ƒã‚„ä»–è€…ã¨ã®ç›¸äº’ä½œç”¨ãŒæ”¯é…çš„ãªçŠ¶æ³ã§ã¯ã€ä»–è€…è¡Œå‹•ã‚„ç’°å¢ƒå¤‰åŒ–ã®äºˆæ¸¬å›°é›£æ€§ãŒæœ¬è³ªçš„ã«å¢—å¤§ã—ã€å¾“æ¥ã®ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬åˆ¶å¾¡ï¼ˆMPCï¼‰ã‚„å¼·åŒ–å­¦ç¿’ï¼ˆRLï¼‰ã«åŸºã¥ãæ‰‹æ³•ã¯ã€éåº¦ã«ä¿å®ˆçš„ãªå›é¿è¡Œå‹•ã€ä¸å®‰å®šãªæŒ¯å‹•ã€ã•ã‚‰ã«ã¯è¡Œå‹•åœæ­¢ï¼ˆFreezingï¼‰ã¨ã„ã£ãŸä¸ç¢ºå®Ÿæ€§èµ·å› ã®è¡Œå‹•ç ´ç¶»ã‚’å¼•ãèµ·ã“ã—ã‚„ã™ã„ã€‚

ã“ã‚Œã‚‰ã®å•é¡Œã¯ã€ä¸ç¢ºå®Ÿæ€§ã‚’æŠ‘åˆ¶ã™ã¹ããƒã‚¤ã‚ºã‚„èª¤å·®ã¨ã—ã¦ã®ã¿æ‰±ã„ã€è¡Œå‹•ç”Ÿæˆã‚’èª¿åœã™ã‚‹è¨­è¨ˆå¤‰æ•°ã¨ã—ã¦æ˜ç¤ºçš„ã«çµ„ã¿è¾¼ã‚“ã§ã“ãªã‹ã£ãŸã“ã¨ã«èµ·å› ã™ã‚‹ã€‚ç‰¹ã«ã€**Active Inferenceã§ä¸­å¿ƒçš„å½¹å‰²ã‚’æœãŸã™Surpriseï¼ˆäºˆæ¸¬å›°é›£åº¦ï¼‰** ã®æœ€å°åŒ–ãŒå®Ÿè£…ã•ã‚Œã¦ãŠã‚‰ãšã€ã‹ã¤ç’°å¢ƒã‚„ä»–è€…ã«å¯¾ã™ã‚‹ç¢ºä¿¡åº¦ã®é•ã„ãŒã€çŸ¥è¦šã‚„æ„æ€æ±ºå®šã®ã€Œé‹­ã•ã€ã«ã©ã®ã‚ˆã†ã«åæ˜ ã•ã‚Œã‚‹ã¹ãã‹ã¨ã„ã†è¨­è¨ˆåŸç†ãŒã€å·¥å­¦çš„ã«ååˆ†æ•´ç†ã•ã‚Œã¦ã„ãªã„ã€‚

### ç›®çš„ (Objective)

æœ¬ç ”ç©¶ã®ç›®çš„ã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFree Energy Principle; FEPï¼‰ãŠã‚ˆã³ Active Inference ã®ç†è«–çš„æ çµ„ã¿ã«åŸºã¥ãã€ä»¥ä¸‹ã®äºŒå±¤åˆ¶å¾¡æ©Ÿæ§‹ã‚’ç¢ºç«‹ã™ã‚‹ã“ã¨ã§ã‚ã‚‹ï¼š

1. **è¡Œå‹•å±¤ï¼ˆAction Layerï¼‰**: **Surprise** ã‚’è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®é …ã¨ã—ã¦æ˜ç¤ºçš„ã«çµ„ã¿è¾¼ã¿ã€äºˆæ¸¬å›°é›£ãªè¡Œå‹•ã‚’å›é¿ã™ã‚‹
2. **çŸ¥è¦šå±¤ï¼ˆPerception Layerï¼‰**: **Haze** ã‚’è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å°å…¥ã—ã€çŸ¥è¦šè§£åƒåº¦ã‚’å¤‰èª¿ã™ã‚‹

ææ¡ˆã™ã‚‹ EPH ã¯ã€Surpriseã«ã‚ˆã‚‹è¡Œå‹•è©•ä¾¡ã¨ã€Hazeã«ã‚ˆã‚‹çŸ¥è¦šå¤‰èª¿ã‚’çµ±åˆã™ã‚‹ã“ã¨ã§ã€é©åˆ‡ãªHazeè¨­å®šã®ä¸‹ã§ã€ä¸ç¢ºå®Ÿæ€§ãŒé«˜ã„çŠ¶æ³ã§ã¯é¦´æŸ“ã¿ã®ã‚ã‚‹è¡Œå‹•ã‚’é¸æŠã—ã¤ã¤çŸ¥è¦šè¡¨ç¾ã‚’å¹³å‡åŒ–ã—ã€ç¢ºä¿¡åº¦ãŒé«˜ã„çŠ¶æ³ã§ã¯åŠ¹ç‡çš„ã‹ã¤é‹­æ•ãªåˆ¤æ–­ã‚’å¯èƒ½ã¨ã™ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æä¾›ã™ã‚‹ã€‚

### å­¦è¡“çš„æ–°è¦æ€§ (Academic Novelty)

æœ¬ç ”ç©¶ã®å­¦è¡“çš„æ–°è¦æ€§ã¯ã€ä»¥ä¸‹ã®3ç‚¹ã«ã‚ã‚‹ï¼š

1. **Active Inferenceã®å·¥å­¦çš„å®Ÿè£…**: Surpriseã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆVAEï¼‰ã®å†æ§‹æˆèª¤å·®ã¨ã—ã¦å®šé‡åŒ–ã—ã€è¡Œå‹•é¸æŠã®ç›®çš„é–¢æ•°ã«çµ±åˆã—ãŸ
2. **çŸ¥è¦šè§£åƒåº¦ã®è¨­è¨ˆåŸç†**: Hazeã‚’è¨­è¨ˆè€…ãŒåˆ¶å¾¡å¯èƒ½ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å°å…¥ã—ã€Precisionï¼ˆçŸ¥è¦šé‹­æ•åº¦ï¼‰ã®å¤‰èª¿ã‚’å®Ÿç¾ã—ãŸ
3. **äºŒå±¤åˆ¶å¾¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: Surpriseã¨Hazeã‚’ç‹¬ç«‹ã—ãŸè¨­è¨ˆæ¬¡å…ƒã¨ã—ã¦åˆ†é›¢ã—ã€ãã‚Œãã‚Œã®å½¹å‰²ã‚’æ˜ç¢ºåŒ–ã—ãŸ

ã•ã‚‰ã«ã€å°†æ¥æ‹¡å¼µã¨ã—ã¦ **Self-Hazingï¼ˆè‡ªå¾‹çš„Hazeå­¦ç¿’ï¼‰** ã®ç†è«–çš„æ çµ„ã¿ã‚’æç¤ºã—ã€è¨­è¨ˆè€…åˆ¶å¾¡ã‹ã‚‰è‡ªå¾‹åˆ¶å¾¡ã¸ã®é€²åŒ–ãƒ‘ã‚¹ã‚’ç¤ºã™ã€‚

### ç†è«–çš„ä½ç½®ã¥ã‘

æœ¬ç ”ç©¶ã¯ã€FEPã®å·¥å­¦çš„å†è§£é‡ˆã¨ã—ã¦ä½ç½®ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚å¾“æ¥ã®è§£é‡ˆã§ã¯ Precision ãŒäºˆæ¸¬èª¤å·®ã®ä¿¡é ¼æ€§é‡ã¿ã¨ã—ã¦æš—é»™çš„ã«ç”¨ã„ã‚‰ã‚Œã¦ããŸãŒã€æœ¬ç ”ç©¶ã§ã¯ä»¥ä¸‹ã®æ˜ç¢ºãªåˆ†é›¢ã‚’è¡Œã†ï¼š

- **æ¨è«–Precision**: äºˆæ¸¬èª¤å·®é …ã®é‡ã¿ï¼ˆå›ºå®šå€¤ã¨ã—ã¦æ‰±ã†ï¼‰
- **çŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î²**: Hazeã‹ã‚‰å°å‡ºã•ã‚Œã€SPMç”Ÿæˆæ™‚ã®é›†ç´„ã®é‹­ã•ã‚’åˆ¶å¾¡

ã“ã®åˆ†é›¢ã«ã‚ˆã‚Šã€ç†è«–çš„æ··ä¹±ã‚’å›é¿ã—ã¤ã¤ã€å·¥å­¦çš„ã«å®Ÿè£…å¯èƒ½ãªåˆ¶å¾¡æ§‹é€ ã‚’ç¢ºç«‹ã™ã‚‹ã€‚

---

# 1. åºè«– (Introduction)

## 1.1 èƒŒæ™¯ (Background)

å…¬å…±ç©ºé–“ã«ãŠã„ã¦ãƒ­ãƒœãƒƒãƒˆãŒäººé–“ã¨å…±å­˜ã—ãªãŒã‚‰æ´»å‹•ã™ã‚‹ãŸã‚ã«ã¯ã€å®‰å…¨æ€§ã®ã¿ãªã‚‰ãšã€å‘¨å›²ã¨ã®èª¿å’Œã‚„ç¤¾ä¼šçš„å—å®¹æ€§ã‚’æº€ãŸã™è¡Œå‹•ç”ŸæˆãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚ç‰¹ã«é§…æ§‹å†…ã€å•†æ¥­æ–½è¨­ã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã¨ã„ã£ãŸæ··é›‘ç’°å¢ƒã§ã¯ã€ä»–è€…ã®è¡Œå‹•ãŒç›¸äº’ã«å½±éŸ¿ã—åˆã„ã€ç’°å¢ƒã®å°†æ¥çŠ¶æ…‹ã‚’æ­£ç¢ºã«äºˆæ¸¬ã™ã‚‹ã“ã¨ãŒæœ¬è³ªçš„ã«å›°é›£ã¨ãªã‚‹ã€‚

ã“ã®ã‚ˆã†ãªçŠ¶æ³ä¸‹ã«ãŠã„ã¦ã€å¾“æ¥ã®ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬åˆ¶å¾¡ï¼ˆMPCï¼‰ã‚„å¼·åŒ–å­¦ç¿’ï¼ˆRLï¼‰ã«åŸºã¥ããƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹æ³•ã¯ã€å®‰å…¨æ€§ã‚’å„ªå…ˆã™ã‚‹ã‚ã¾ã‚Šã€éåº¦ã«ä¿å®ˆçš„ãªå›é¿è¡Œå‹•ã‚„ã€å¾®å°ãªäºˆæ¸¬èª¤å·®ã«å¯¾ã™ã‚‹éå‰°åå¿œã‚’ç¤ºã™ã“ã¨ãŒã‚ã‚‹ã€‚ãã®çµæœã¨ã—ã¦ã€ãƒ­ãƒœãƒƒãƒˆãŒãã®å ´ã§åœæ­¢ã—ã¦ã—ã¾ã† **Freezing**ã€ã‚ã‚‹ã„ã¯å‰é€²ã¨å›é¿ã‚’ç¹°ã‚Šè¿”ã™æŒ¯å‹•çš„æŒ™å‹•ãŒç™ºç”Ÿã—ã€å®Ÿé‹ç”¨ã«ãŠã‘ã‚‹ä¿¡é ¼æ€§ã‚’è‘—ã—ãæãªã†ã€‚

Freezing ã¯ã—ã°ã—ã°ã€Œå¤±æ•—äº‹ä¾‹ã€ã‚„ã€Œãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ä¸è¶³ã€ã¨ã—ã¦æ‰±ã‚ã‚Œã¦ããŸãŒã€å®Ÿéš›ã«ã¯ã€**ä¸ç¢ºå®Ÿæ€§ã®é«˜ã„çŠ¶æ³ã«ãŠã„ã¦æœ€é©ãªè¡Œå‹•é¸æŠã¨çŸ¥è¦šã®ç²’åº¦åˆ¶å¾¡ãŒçµ±åˆã•ã‚Œã¦ã„ãªã„**è¨­è¨ˆãã®ã‚‚ã®ã«èµ·å› ã™ã‚‹æ§‹é€ çš„å•é¡Œã§ã‚ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚

### Active Inferenceã«ãŠã‘ã‚‹ Surprise ã®å½¹å‰²

è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFEPï¼‰ã«åŸºã¥ã Active Inference ã§ã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ **Expected Free Energy (EFE)** ã‚’æœ€å°åŒ–ã™ã‚‹è¡Œå‹•ã‚’é¸æŠã™ã‚‹ã€‚EFEã¯ä»¥ä¸‹ã®ã‚ˆã†ã«åˆ†è§£ã•ã‚Œã‚‹ï¼š

$$
G(\boldsymbol{u}) = \underbrace{\mathbb{E}[-\log p(\boldsymbol{o}|\boldsymbol{s}, \boldsymbol{u})]}_{\text{Surprise (ãƒªã‚¹ã‚¯)}} + \underbrace{D_{KL}[q(\boldsymbol{s}|\boldsymbol{o}, \boldsymbol{u}) \| p(\boldsymbol{s}|\boldsymbol{u})]}_{\text{Ambiguity (æ›–æ˜§æ€§)}}
$$

**Surprise** ã¯ã€è¦³æ¸¬ $\boldsymbol{o}$ ãŒçŠ¶æ…‹ $\boldsymbol{s}$ ã¨è¡Œå‹• $\boldsymbol{u}$ ã®çµ„ã¿åˆã‚ã›ã«ãŠã„ã¦ã©ã‚Œã ã‘ã€Œäºˆæƒ³å¤–ã€ã§ã‚ã‚‹ã‹ã‚’è¡¨ã™ã€‚SurpriseãŒé«˜ã„è¡Œå‹•ï¼ˆä¾‹: å­¦ç¿’ã—ã¦ã„ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã€OODæ¡ä»¶ï¼‰ã¯é¿ã‘ã‚‰ã‚Œã€é¦´æŸ“ã¿ã®ã‚ã‚‹è¡Œå‹•ãŒé¸å¥½ã•ã‚Œã‚‹ã€‚

ã—ã‹ã—ã€å¾“æ¥ã®å·¥å­¦çš„å®Ÿè£…ã§ã¯ã€ã“ã®Surpriseé …ãŒçœç•¥ã•ã‚Œã‚‹ã‹ã€æš—é»™çš„ã«ã—ã‹æ‰±ã‚ã‚Œã¦ã“ãªã‹ã£ãŸã€‚æœ¬ç ”ç©¶ã§ã¯ã€Surpriseã‚’ **VAEå†æ§‹æˆèª¤å·®** ã¨ã—ã¦å®šé‡åŒ–ã—ã€è¡Œå‹•é¸æŠã«æ˜ç¤ºçš„ã«çµ„ã¿è¾¼ã‚€ã€‚

### çŸ¥è¦šè§£åƒåº¦ã®è¨­è¨ˆèª²é¡Œ

ã•ã‚‰ã«ã€ã€Œç¢ºä¿¡ãŒæŒã¦ãªã„çŠ¶æ³ã§ã¯ã€ã©ã®ç¨‹åº¦ã¾ã§ç’°å¢ƒã‚’è©³ç´°ã«è¦‹ã‚‹ã¹ãã‹ã€ã¨ã„ã†èªçŸ¥çš„åˆ¶å¾¡åŸç†ãŒã€å·¥å­¦çš„ã«æ˜ç¤ºã•ã‚Œã¦ã“ãªã‹ã£ãŸç‚¹ã«æœ¬è³ªçš„ãªèª²é¡ŒãŒå­˜åœ¨ã™ã‚‹ã€‚æœ¬ç ”ç©¶ã§ã¯ã€ã“ã®å•é¡Œã‚’ **Haze** ã¨ã„ã†è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦è§£æ±ºã™ã‚‹ã€‚

## 1.2 ç›®çš„ (Objective)

æœ¬ç ”ç©¶ã®ç›®çš„ã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFEPï¼‰ãŠã‚ˆã³ Active Inference ã®æ çµ„ã¿ã«åŸºã¥ãã€ä»¥ä¸‹ã®äºŒå±¤åˆ¶å¾¡æ©Ÿæ§‹ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ã§ã‚ã‚‹ï¼š

### è¡Œå‹•å±¤ï¼šSurpriseæœ€å°åŒ–

è¡Œå‹•é¸æŠã«ãŠã„ã¦ã€ä»¥ä¸‹ã®æ‹¡å¼µè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æœ€å°åŒ–ã™ã‚‹ï¼š

$$
F(\boldsymbol{u}) = F_{\text{goal}}(\boldsymbol{u}) + F_{\text{safety}}(\boldsymbol{u}) + \lambda_s \cdot S(\boldsymbol{u})
$$

ã“ã“ã§ã€$S(\boldsymbol{u})$ ã¯Surpriseï¼ˆVAEå†æ§‹æˆèª¤å·®ï¼‰ã§ã‚ã‚Šã€å­¦ç¿’æ¸ˆã¿ã®é¦´æŸ“ã¿ã®ã‚ã‚‹è¡Œå‹•ã‚’é¸å¥½ã™ã‚‹åŠ¹æœã‚’æŒã¤ã€‚

### çŸ¥è¦šå±¤ï¼šHazeå¤‰èª¿

çŸ¥è¦šè§£åƒåº¦ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ **Haze** ã‚’å°å…¥ã—ã€ãã‚Œã«åŸºã¥ã„ã¦Precision $\beta$ ã‚’å¤‰èª¿ã™ã‚‹ï¼š

$$
\beta[k] = f_{\text{precision}}(\text{Haze}[k])
$$

Hazeã¯è¨­è¨ˆè€…ãŒåˆ¶å¾¡ã™ã‚‹å¤‰æ•°ã§ã‚ã‚Šã€ä»¥ä¸‹ã®3ãƒ¢ãƒ¼ãƒ‰ã‚’æƒ³å®šã™ã‚‹ï¼š
- **å›ºå®šãƒ¢ãƒ¼ãƒ‰**: Haze = 0.0ï¼ˆå…¨ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã§ä¸€å®šã€Phase 1-5ï¼‰
- **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ‰**: ç’°å¢ƒçŠ¶æ…‹ï¼ˆå¯†åº¦ã€ãƒªã‚¹ã‚¯ï¼‰ã«å¿œã˜ã¦è¨­å®š
- **Self-Hazingãƒ¢ãƒ¼ãƒ‰**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªå¾‹çš„ã«å­¦ç¿’ï¼ˆPhase 6ã§å®Ÿè£…äºˆå®šï¼‰

**æ³¨**: Phase 1-5ã§ã¯å®Ÿè¡Œæ™‚Hazeã‚’å¯å¤‰ã¨ã›ãšã€å›ºå®šå€¤ï¼ˆä¾‹: 0.3, 0.5, 0.7ï¼‰ã§ã®æ¯”è¼ƒå®Ÿé¨“ã«ã‚ˆã‚Šã€Hazeã®åŠ¹æœã‚’æ¤œè¨¼ã™ã‚‹ã€‚

### çµ±åˆã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ 

ææ¡ˆã™ã‚‹EPHã¯ã€Surpriseã«ã‚ˆã‚‹OODå›é¿ã¨ã€Hazeã«ã‚ˆã‚‹çŸ¥è¦šç²—è¦–åŒ–ã‚’çµ±åˆã™ã‚‹ã“ã¨ã§ã€ä¸ç¢ºå®Ÿæ€§ãŒé«˜ã„çŠ¶æ³ã§ã‚‚å®‰å®šã—ãŸè¡Œå‹•ç”Ÿæˆã‚’å®Ÿç¾ã™ã‚‹ã€‚

æœ¬ç ”ç©¶ã¯ã€æ··é›‘ç’°å¢ƒã«ãŠã‘ã‚‹å˜ä½“ãƒ­ãƒœãƒƒãƒˆã®ç¤¾ä¼šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸»è¦ãªå¿œç”¨ä¾‹ã¨ã—ã¤ã¤ã‚‚ã€ãã®å°„ç¨‹ã‚’å˜ä½“ã‚·ã‚¹ãƒ†ãƒ ã«é™å®šã›ãšã€ç¾¤çŸ¥èƒ½ã‚„åˆ†æ•£å‹è‡ªå¾‹ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦ã‚‚æˆç«‹ã™ã‚‹ä¸€èˆ¬çš„ãªè¨­è¨ˆåŸç†ã¨ã—ã¦æç¤ºã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã™ã€‚

## 1.3 å­¦è¡“çš„æ–°è¦æ€§ (Academic Novelty)

æœ¬ç ”ç©¶ã®å­¦è¡“çš„æ–°è¦æ€§ã¯ã€ä»¥ä¸‹ã®3ç‚¹ã«ã‚ã‚‹ï¼š

### (1) Active Inference ã®å·¥å­¦çš„å®Ÿè£…

å¾“æ¥ã®å·¥å­¦çš„å®Ÿè£…ã§çœç•¥ã•ã‚Œã¦ããŸ **Surpriseé …** ã‚’ã€VAEå†æ§‹æˆèª¤å·®ã¨ã—ã¦å®šé‡åŒ–ã—ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«æ˜ç¤ºçš„ã«çµ„ã¿è¾¼ã‚“ã ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç†è«–ã¨å®Ÿè£…ã®æ•´åˆæ€§ã‚’ç¢ºä¿ã—ãŸã€‚

$$
S(\boldsymbol{u}) = \|\boldsymbol{y}[k] - \text{VAE}_{\text{recon}}(\boldsymbol{y}[k], \boldsymbol{u})\|^2
$$

**è¨­è¨ˆã®éµ**: VAEã‚’ **Haze=0ï¼ˆæœ€é«˜è§£åƒåº¦ï¼‰** ã®SPMã§è¨“ç·´ã—ã€å®Ÿè¡Œæ™‚ã«ã¯è¨­è¨ˆè€…ãŒè¨­å®šã—ãŸHazeå€¤ã«å¿œã˜ã¦ç”Ÿæˆã•ã‚ŒãŸSPMã‚’å…¥åŠ›ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€HazeãŒé«˜ã„ã»ã©SPMãŒç²—ããªã‚Šã€çµæœã¨ã—ã¦SurpriseãŒå¢—åŠ ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

**é‡è¦**: VAEã¯Hazeã‚’è¨ˆç®—ãƒ»æ¤œå‡ºã—ãªã„ã€‚Hazeã®åŠ¹æœã¯SPMç”Ÿæˆæ™‚ã®Î²å¤‰èª¿ã‚’é€šã˜ã¦é–“æ¥çš„ã«ç¾ã‚Œã‚‹ã€‚

### (2) Haze ã®è¨­è¨ˆåŸç†

Hazeã‚’ **è¨­è¨ˆè€…ãŒåˆ¶å¾¡å¯èƒ½ãªãƒ¡ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** ã¨ã—ã¦å°å…¥ã—ã€VAEã®æ½œåœ¨ç©ºé–“ä¸ç¢ºå®Ÿæ€§ï¼ˆ$\sigma_z^2$ï¼‰ã¨ã¯ç‹¬ç«‹ã—ãŸè¨­è¨ˆæ¬¡å…ƒã¨ã—ã¦æ‰±ã†ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ãŒå¯èƒ½ã¨ãªã‚‹ï¼š

- è¨­è¨ˆè€…ã«ã‚ˆã‚‹æ˜ç¤ºçš„ãªçŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡
- VAEã®å­¦ç¿’ã¨ã¯ç‹¬ç«‹ã—ãŸHazeè¨­å®šï¼ˆå›ºå®šã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
- å°†æ¥çš„ãªSelf-Hazingï¼ˆè‡ªå¾‹å­¦ç¿’ï¼‰ã¸ã®æ‹¡å¼µãƒ‘ã‚¹

### (3) äºŒå±¤åˆ¶å¾¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

Surpriseã¨Hazeã‚’ç‹¬ç«‹ã—ãŸåˆ¶å¾¡å±¤ã¨ã—ã¦åˆ†é›¢ï¼š

| å±¤ | åˆ¶å¾¡å¯¾è±¡ | å…¥åŠ› | å‡ºåŠ› | å½¹å‰² |
|----|---------|------|------|------|
| **è¡Œå‹•å±¤** | è¡Œå‹•é¸æŠ | SPM, Goal, Surprise | $\boldsymbol{u}^*$ | OODå›é¿ã€ç›®æ¨™é”æˆ |
| **çŸ¥è¦šå±¤** | çŸ¥è¦šè§£åƒåº¦ | Haze | $\beta$ | é›†ç´„ã®é‹­ã•åˆ¶å¾¡ |

ã“ã®åˆ†é›¢ã«ã‚ˆã‚Šã€å„å±¤ã®è¨­è¨ˆã¨æ¤œè¨¼ãŒç‹¬ç«‹ã—ã¦è¡Œãˆã‚‹ã¨ã„ã†å·¥å­¦çš„åˆ©ç‚¹ãŒç”Ÿã¾ã‚Œã‚‹ã€‚

### (4) Precision æ¦‚å¿µã®æ˜ç¢ºåŒ–

è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ã«ãŠã‘ã‚‹ Precision ã®æ›–æ˜§ã•ã‚’è§£æ¶ˆï¼š

- **æ¨è«–Precision**: äºˆæ¸¬èª¤å·®ã®ä¿¡é ¼æ€§é‡ã¿ï¼ˆç†è«–çš„æ¦‚å¿µã€å›ºå®šå€¤ï¼‰
- **çŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î²**: å®Ÿè£…ä¸Šã®åˆ¶å¾¡å¤‰æ•°ï¼ˆHazeã‹ã‚‰å°å‡ºï¼‰

ã“ã®åˆ†é›¢ã«ã‚ˆã‚Šã€ç†è«–çš„æ··ä¹±ã‚’å›é¿ã—ã¤ã¤ã€å®Ÿè£…å¯èƒ½ãªè¨­è¨ˆæ§‹é€ ã‚’ç¢ºç«‹ã—ãŸã€‚

### (5) Self-Hazing ã®ç†è«–çš„æ çµ„ã¿

å°†æ¥æ‹¡å¼µã¨ã—ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªå¾‹çš„ã«æœ€é©Hazeã‚’å­¦ç¿’ã™ã‚‹ **Self-Hazing** ã®ç†è«–çš„æ çµ„ã¿ã‚’æç¤ºï¼š

$$
\text{Haze}[k] = \pi_{\text{haze}}(\text{observation\_history}, \text{task\_context}, \sigma_z^2, \ldots)
$$

**é‡è¦**: ã“ã‚Œã¯ **Phase 6 ã®å°†æ¥ç ”ç©¶** ã§ã‚ã‚‹ã€‚Phase 1-5ã§ã¯ã€Hazeã¯è¨­è¨ˆè€…ãŒå›ºå®šå€¤ã¨ã—ã¦è¨­å®šã™ã‚‹ã€‚Self-Hazingã§ã¯ã€VAEã® $\sigma_z^2$ ãŒ Hazeæ±ºå®šã® **å…¥åŠ›ã®ä¸€è¦ç´ ** ã¨ã—ã¦åˆ©ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŒã€ã“ã‚Œã¯VAEãŒHazeã‚’è¨ˆç®—ã™ã‚‹ã®ã§ã¯ãªãã€åˆ¥ã®ãƒãƒªã‚·ãƒ¼ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ $\pi_{\text{haze}}$ ãŒHazeã‚’æ±ºå®šã™ã‚‹ã“ã¨ã‚’æ„å‘³ã™ã‚‹ã€‚

ã“ã‚Œã¯ **ãƒ¡ã‚¿å­¦ç¿’**ï¼ˆå­¦ç¿’ã®å­¦ç¿’ï¼‰ã«ç›¸å½“ã—ã€è¨­è¨ˆè€…åˆ¶å¾¡ã‹ã‚‰è‡ªå¾‹åˆ¶å¾¡ã¸ã®é€²åŒ–ãƒ‘ã‚¹ã‚’ç¤ºã™ã€‚

---

# 2. ç†è«–çš„åŸºç›¤ (Theoretical Foundation)

æœ¬ç« ã§ã¯ã€æœ¬ç ”ç©¶ã§ææ¡ˆã™ã‚‹ Emergent Perceptual Hazeï¼ˆEPHï¼‰v5.6 ã®ç†è«–çš„åŸºç›¤ã‚’æ•´ç†ã™ã‚‹ã€‚ã¾ãšã€å¯¾è±¡ã¨ã™ã‚‹é‹å‹•ãƒ¢ãƒ‡ãƒ«ã¨è¡Œå‹•ç”Ÿæˆã®æ çµ„ã¿ã‚’å®šå¼åŒ–ã—ã€æ¬¡ã« **Active Inference ã«åŸºã¥ãè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆSurpriseçµ±åˆç‰ˆï¼‰** ã‚’å®šç¾©ã™ã‚‹ã€‚ãã®ä¸Šã§ã€ä¸ç¢ºå®Ÿæ€§æŒ‡æ¨™ Haze ã®å†å®šç¾©ã€Precision ã®å½¹å‰²åˆ†é›¢ã€ãŠã‚ˆã³å¾ªç’°ä¾å­˜ã®è§£æ¶ˆã«ã¤ã„ã¦è©³è¿°ã™ã‚‹ã€‚

---

## 2.1 å•é¡Œå®šå¼åŒ– (Problem Formulation)

æœ¬ç ”ç©¶ã§ã¯ã€ç§»å‹•ãƒ­ãƒœãƒƒãƒˆã®é‹å‹•ã‚’ä»¥ä¸‹ã® 2 æ¬¡é…ã‚Œç³»ã¨ã—ã¦ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹ã€‚

$$
M \ddot{\boldsymbol{x}}[k] + D \dot{\boldsymbol{x}}[k] = \boldsymbol{u}[k]
$$

ã“ã“ã§ã€$\boldsymbol{x}[k] \in \mathbb{R}^2$ ã¯ãƒ­ãƒœãƒƒãƒˆã®ä½ç½®ã€$\dot{\boldsymbol{x}}[k]$ ã¯é€Ÿåº¦ã€$\boldsymbol{u}[k]$ ã¯åˆ¶å¾¡å…¥åŠ›ã‚’è¡¨ã™ã€‚$M$ ãŠã‚ˆã³ $D$ ã¯ãã‚Œãã‚Œè³ªé‡è¡Œåˆ—ãŠã‚ˆã³ç²˜æ€§è¡Œåˆ—ã§ã‚ã‚‹ã€‚

ãƒ­ãƒœãƒƒãƒˆã®ç›®çš„ã¯ã€ç›®æ¨™ä½ç½® $\boldsymbol{x}_g$ ã¸ã®åˆ°é”ã¨ã€ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚„éšœå®³ç‰©ã¨ã®è¡çªå›é¿ã‚’åŒæ™‚ã«æº€ãŸã™è¡Œå‹•ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚æœ¬ç ”ç©¶ã§ã¯ã€ã“ã®ç›®çš„ã‚’ **æ‹¡å¼µè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼æœ€å°åŒ–å•é¡Œï¼ˆSurpriseçµ±åˆç‰ˆï¼‰** ã¨ã—ã¦å®šå¼åŒ–ã™ã‚‹ã€‚

---

## 2.2 å·¥å­¦çš„è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å®šç¾©ï¼ˆv5.6: Surpriseçµ±åˆç‰ˆï¼‰

è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFree Energy Principle; FEPï¼‰ã¯ã€æœ¬æ¥ã€çŸ¥è¦šã¨è¡Œå‹•ã‚’çµ±ä¸€çš„ã«èª¬æ˜ã™ã‚‹ç†è«–çš„æ çµ„ã¿ã§ã‚ã‚Šã€äºˆæ¸¬èª¤å·®ã‚’æœ€å°åŒ–ã™ã‚‹æ–¹å‘ã«å†…éƒ¨çŠ¶æ…‹ã‚„è¡Œå‹•ãŒæ›´æ–°ã•ã‚Œã‚‹ã¨è§£é‡ˆã•ã‚Œã‚‹ã€‚æœ¬ç ”ç©¶ã§ã¯ã€ã“ã®è€ƒãˆæ–¹ã‚’å·¥å­¦çš„ã«è§£é‡ˆã—ã€**Surpriseã‚’æ˜ç¤ºçš„ã«å«ã‚€æ‹¡å¼µè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼** ã‚’è¡Œå‹•ç”Ÿæˆã®ãŸã‚ã®ç›®çš„é–¢æ•°ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚

### 2.2.1 è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å®šç¾©ï¼ˆv5.6ï¼‰

æœ¬ç ”ç©¶ã«ãŠã‘ã‚‹è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ $F[k]$ ã¯ã€**äºˆæ¸¬ã•ã‚ŒãŸå°†æ¥ã®SPMã¨ã€ç¾åœ¨ã®è¡Œå‹•ã®Surprise** ã«åŸºã¥ã„ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚

$$
F(\boldsymbol{u}[k]) = F_{\text{goal}}(\boldsymbol{u}) + F_{\text{safety}}(\boldsymbol{u}) + \lambda_s \cdot S(\boldsymbol{u})
$$

#### (1) ç›®æ¨™åˆ°é”é …

$$
F_{\text{goal}}(\boldsymbol{u}) = \|\hat{\boldsymbol{x}}[k+1](\boldsymbol{u}) - \boldsymbol{x}_g\|^2
$$

- $\hat{\boldsymbol{x}}[k+1]$: è¡Œå‹• $\boldsymbol{u}$ ã«ã‚ˆã‚‹äºˆæ¸¬ä½ç½®

#### (2) å®‰å…¨æ€§é …ï¼ˆéšœå®³å›é¿ï¼‰

$$
F_{\text{safety}}(\boldsymbol{u}) = \lambda_{\text{safe}} \sum_{m,n} \phi(\hat{\boldsymbol{y}}_{m,n}[k+1](\boldsymbol{u}))
$$

- $\hat{\boldsymbol{y}}[k+1]$: VAEã«ã‚ˆã‚‹äºˆæ¸¬SPM
- $\phi(\cdot)$: è¡çªå±é™ºæ€§ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–¢æ•°ï¼ˆä¾‹: Ch2, Ch3ã®é‡ã¿ä»˜ãå’Œï¼‰

#### (3) Surpriseé … â˜…v5.6 æ–°è¦è¿½åŠ â˜…

$$
S(\boldsymbol{u}) = \|\boldsymbol{y}[k] - \text{VAE}_{\text{recon}}(\boldsymbol{y}[k], \boldsymbol{u})\|^2
$$

**æ„å‘³**: ã€Œç¾åœ¨ã®SPM $\boldsymbol{y}[k]$ ã¨è¡Œå‹• $\boldsymbol{u}$ ã®ãƒšã‚¢ãŒã©ã‚Œã ã‘äºˆæƒ³å¤–ã‹ã€

**è¨ˆç®—æ–¹æ³•**:

$$
\text{VAE}_{\text{recon}}(\boldsymbol{y}, \boldsymbol{u}) = \text{Decoder}(\text{Encoder}(\boldsymbol{y}, \boldsymbol{u}), \boldsymbol{u})
$$

1. VAEã®Encoderã§ $(y[k], u[k]) \to q(z|y, u) = \mathcal{N}(\mu_z, \sigma_z^2)$ ã‚’æ¨å®š
2. å¹³å‡ $\mu_z$ ã‚’ä½¿ç”¨ï¼ˆæ±ºå®šè«–çš„ï¼‰
3. Decoderã§ $(z=\mu_z, u) \to y_{\text{recon}}$ ã‚’å†æ§‹æˆ
4. å…ƒã®SPMã¨ã®äºŒä¹—èª¤å·®ã‚’è¨ˆç®—

**å½¹å‰²**:
- **ä½Surprise**: å­¦ç¿’æ¸ˆã¿ã®é¦´æŸ“ã¿ã®ã‚ã‚‹è¡Œå‹• â†’ é¸å¥½ã•ã‚Œã‚‹
- **é«˜Surprise**: æœªå­¦ç¿’ã®OODè¡Œå‹• â†’ å›é¿ã•ã‚Œã‚‹

**ç†è«–çš„æ ¹æ‹ **:
Active Inferenceã«ãŠã„ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯Surpriseã‚’æœ€å°åŒ–ã™ã‚‹è¡Œå‹•ã‚’é¸æŠã™ã‚‹ã€‚ã“ã‚Œã¯ã€Œäºˆæ¸¬å¯èƒ½ãªçŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹ã€ã¨ã„ã†ç”Ÿç‰©å­¦çš„åŸç†ã«å¯¾å¿œã™ã‚‹ã€‚

---

### 2.2.2 äºˆæ¸¬ãƒ™ãƒ¼ã‚¹è¡Œå‹•ç”Ÿæˆï¼ˆPattern D: Action-Dependent Uncertainty World Modelï¼‰

æœ¬ç ”ç©¶ã®æ ¸å¿ƒã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæ“ä½œæŒ‡ä»¤å€¤ $\boldsymbol{u}[k]$ ã‚’é€šã˜ã¦äºˆæ¸¬ SPM **ãŠã‚ˆã³ Surprise** ã«ä¾å­˜ã™ã‚‹ç‚¹ã«ã‚ã‚‹ã€‚v5.6 (Pattern D) ã§ã¯ VAE ã¯ä»¥ä¸‹ã® **è¡Œå‹•ä¾å­˜ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€æ§‹é€ ** ã‚’æŒã¤ï¼š

**ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€**ï¼ˆç¾åœ¨çŠ¶æ…‹ã¨è¡Œå‹•ã‹ã‚‰æ½œåœ¨åˆ†å¸ƒã‚’æ¨å®šï¼‰ï¼š

$$
q_\phi(\boldsymbol{z} \mid \boldsymbol{y}[k], \boldsymbol{u}[k])
=
\mathcal{N}(\boldsymbol{\mu}_z, \mathrm{diag}(\boldsymbol{\sigma}_z^2))
$$

**ãƒ‡ã‚³ãƒ¼ãƒ€**ï¼ˆæ½œåœ¨å¤‰æ•° + æ“ä½œæŒ‡ä»¤å€¤ã‹ã‚‰å°†æ¥ SPM ã‚’äºˆæ¸¬ï¼‰ï¼š

$$
\hat{\boldsymbol{y}}[k+1] = f_{\text{dec}}(\boldsymbol{z}, \boldsymbol{u}[k])
$$

**é‡è¦ãªè¨­è¨ˆåŸå‰‡ï¼ˆv5.6ï¼‰**:
- **ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã« $\boldsymbol{u}$ ãŒå…¥åŠ›ã•ã‚Œã‚‹**: æ½œåœ¨åˆ†å¸ƒ $q(\boldsymbol{z} \mid \boldsymbol{y}, \boldsymbol{u})$ ã¯è¡Œå‹•ã«ä¾å­˜ã—ã¦å¤‰åŒ–ã™ã‚‹
- **VAEã®å½¹å‰²ã¯äºˆæ¸¬ã¨Surpriseè¨ˆç®—**: $\sigma_z^2$ ã¯VAEã®å†…éƒ¨å¤‰æ•°ã§ã‚ã‚Šã€Hazeã¨ã¯ **ç‹¬ç«‹** ã§ã‚ã‚‹
- **Hazeã¯è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**: è¨­è¨ˆè€…ãŒå¤–éƒ¨ã‹ã‚‰è¨­å®šï¼ˆå›ºå®šã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€Self-Hazingï¼‰

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šï¼š
- $\boldsymbol{z}$ = ã€ŒçŠ¶æ…‹ $\boldsymbol{y}$ ã§è¡Œå‹• $\boldsymbol{u}$ ã‚’ã¨ã£ãŸæ™‚ã®é·ç§»ã®ç¬¦å·åŒ–ã€
- $\boldsymbol{\sigma}_z^2$ = ã€Œãã®é·ç§»ã®ä¸ç¢ºå®Ÿæ€§ã€ï¼ˆå°†æ¥Self-Hazingã§åˆ©ç”¨å¯èƒ½ï¼‰
- $\hat{\boldsymbol{y}}$ = ã€Œ$\boldsymbol{z}$ ã®ä¸–ç•Œã§ $\boldsymbol{u}$ ã‚’å®Ÿè¡Œã—ãŸçµæœã€
- $S(\boldsymbol{u})$ = ã€Œ$(y, u)$ ãƒšã‚¢ã®äºˆæ¸¬å›°é›£åº¦ã€

åˆ¶å¾¡å…¥åŠ›ã¯ã€**æ“ä½œæŒ‡ä»¤å€¤ã«é–¢ã™ã‚‹æ‹¡å¼µè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æœ€å°åŒ–**ã¨ã—ã¦ç”Ÿæˆã•ã‚Œã‚‹ï¼š

$$
\boldsymbol{u}^*[k]
=
\arg\min_{\boldsymbol{u}}
\left[
F_{\text{goal}}(\boldsymbol{u}) + F_{\text{safety}}(\boldsymbol{u}) + \lambda_s \cdot S(\boldsymbol{u})
\right]
$$

**å®Ÿè£…ã«ãŠã‘ã‚‹è¿‘ä¼¼**:
å‹¾é…è¨ˆç®—ãŒè¤‡é›‘ãªãŸã‚ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ã‚’ä½¿ç”¨ï¼š

```julia
candidates = [u_baseline + noise for _ in 1:10]
u_optimal = argmin(F(u) for u in candidates)
```

---

### 2.2.3 å‹¾é…è¨ˆç®—ã®ç†è«–çš„æ çµ„ã¿

ç†è«–çš„ã«ã¯ã€$\boldsymbol{u}$ ã«é–¢ã™ã‚‹è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å‹¾é…ã¯ä»¥ä¸‹ã®ãƒã‚§ãƒ¼ãƒ³ãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚Šè¨ˆç®—ã•ã‚Œã‚‹ï¼š

$$
\frac{\partial F}{\partial \boldsymbol{u}}
=
\frac{\partial F_{\text{goal}}}{\partial \boldsymbol{u}}
+
\sum_{m,n}
\frac{\partial \phi(\hat{\boldsymbol{y}}_{m,n})}{\partial \hat{\boldsymbol{y}}_{m,n}}
\cdot
\frac{\partial \hat{\boldsymbol{y}}_{m,n}}{\partial \boldsymbol{u}}
+
\lambda_s \frac{\partial S}{\partial \boldsymbol{u}}
$$

ã“ã“ã§ï¼š
- $\partial \hat{\boldsymbol{y}}_{m,n} / \partial \boldsymbol{u}$ : VAEã‚’é€šã˜ãŸäºˆæ¸¬SPMã®å‹¾é…
- $\partial S / \partial \boldsymbol{u}$ : Surpriseã®å‹¾é…ï¼ˆVAEå†æ§‹æˆã‚’é€šã˜ã¦è¨ˆç®—ï¼‰

**å®Ÿè£…ä¸Šã®èª²é¡Œ**:
VAEãŒFluxã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ForwardDiffçµŒç”±ã®è‡ªå‹•å¾®åˆ†ãŒè¤‡é›‘ã§ã‚ã‚‹ã€‚Phase 1-5ã§ã¯ **ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–** ã‚’æ¡ç”¨ã—ã€Phase 6ä»¥é™ã§å‹¾é…ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ã‚’æ¤œè¨ã™ã‚‹ã€‚

---

## 2.3 Precision æ¦‚å¿µã®æ•´ç†ã¨å½¹å‰²åˆ†é›¢ï¼ˆv5.6æ”¹è¨‚ï¼‰

è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ã«ãŠã„ã¦ Precision ã¯ã€äºˆæ¸¬èª¤å·®ã®ä¿¡é ¼æ€§ã‚’è¡¨ã™é‡ã¿ã¨ã—ã¦å°å…¥ã•ã‚Œã‚‹ï¼ˆFeldman & Friston, 2010ï¼‰ã€‚ã—ã‹ã—ã€å·¥å­¦çš„å®Ÿè£…ã«ãŠã„ã¦ã¯ã€Precision ãŒè¤‡æ•°ã®å½¹å‰²ã‚’æš—é»™çš„ã«æ‹…ã£ã¦ã—ã¾ã„ã€ç†è«–çš„æ··ä¹±ã‚’æ‹›ãå ´åˆãŒã‚ã‚‹ã€‚

v5.6ã§ã¯ã€Precisionã‚’ä»¥ä¸‹ã®2ã¤ã«æ˜ç¢ºã«åˆ†é›¢ã™ã‚‹ï¼š

### 2.3.1 æ¨è«–ã«ãŠã‘ã‚‹ Precisionï¼ˆInference Precisionï¼‰

æ¨è«–ã«ãŠã‘ã‚‹ Precision ã¯ã€äºˆæ¸¬èª¤å·®é …ã®ä¿¡é ¼æ€§é‡ã¿ã¨ã—ã¦è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ç¾ã‚Œã‚‹é‡ã§ã‚ã‚Šã€FEP ã«ãŠã‘ã‚‹æœ¬æ¥ã®å®šç¾©ã«å¯¾å¿œã™ã‚‹ã€‚æœ¬ç ”ç©¶ã§ã¯ã€ã“ã®æ¨è«– Precision ã¯ **å›ºå®šå€¤ã¨ã—ã¦æ‰±ã„**ã€å­¦ç¿’ã‚„åˆ¶å¾¡ã®å¯¾è±¡ã¨ã¯ã—ãªã„ã€‚

### 2.3.2 çŸ¥è¦šè§£åƒåº¦ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆPerceptual Resolution Parameterï¼‰

$\beta$ ã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¸­ã®èª¤å·®é …ã‚’ç›´æ¥é‡ã¿ä»˜ã‘ã™ã‚‹é‡ã§ã¯ãªãã€çŸ¥è¦šè¡¨ç¾ï¼ˆSPMï¼‰ã«ãŠã‘ã‚‹ soft é›†ç´„ã®é‹­ã•ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ¡ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚ã“ã®å½¹å‰²åˆ†é›¢ã«ã‚ˆã‚Šã€Precision ã®äºŒé‡åˆ©ç”¨ã«ã‚ˆã‚‹ç†è«–çš„ä¸æ•´åˆã‚’å›é¿ã™ã‚‹ã€‚

$$
\beta[k] = f_{\text{precision}}(\text{Haze}[k])
$$

ã“ã“ã§ã€**Haze ã¯è¨­è¨ˆè€…ãŒåˆ¶å¾¡ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** ã§ã‚ã‚Šã€VAEã® $\sigma_z^2$ ã¨ã¯ç‹¬ç«‹ã§ã‚ã‚‹ã€‚

**æ•°å¼ä¾‹ï¼ˆé€†åŒæ›²ç·šï¼‰**:

$$
\beta[k] = \frac{\beta_{\max}}{1 + \alpha \cdot \text{Haze}[k]}
$$

- $\beta_{\max}$: æœ€å¤§çŸ¥è¦šç²¾åº¦ï¼ˆä¾‹: 10.0ï¼‰
- $\alpha$: æ„Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä¾‹: 1.0ï¼‰
- $\text{Haze}[k] \in [0, 1]$: è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

**è§£é‡ˆ**:
- $\text{Haze} = 0$ â†’ $\beta = \beta_{\max}$ â†’ é‹­æ•ãªçŸ¥è¦š
- $\text{Haze} = 1$ â†’ $\beta = \beta_{\max} / 2$ â†’ ç²—ã„çŸ¥è¦š

---

## 2.4 ä¸ç¢ºå®Ÿæ€§æŒ‡æ¨™ Haze ã®å®šç¾©ï¼ˆv5.6æ”¹è¨‚ï¼šè¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ï¼‰

### 2.4.1 ä¸ç¢ºå®Ÿæ€§ã®ç¨®é¡ã¨æœ¬ç ”ç©¶ã®ç«‹å ´

ä¸ç¢ºå®Ÿæ€§ã¯å¤§ãã **ã‚¨ãƒ”ã‚¹ãƒ†ãƒŸãƒƒã‚¯ä¸ç¢ºå®Ÿæ€§**ï¼ˆçŸ¥è­˜ä¸è¶³ï¼‰ã¨ **ã‚¢ãƒ¬ã‚¢ãƒˆãƒªãƒƒã‚¯ä¸ç¢ºå®Ÿæ€§**ï¼ˆæœ¬è³ªçš„ãƒ©ãƒ³ãƒ€ãƒ æ€§ï¼‰ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚æœ¬ç ”ç©¶ã«ãŠã‘ã‚‹ Haze ã¯ã€**çŸ¥è¦šè§£åƒåº¦ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** ã§ã‚ã‚Šã€ç‰¹å®šã®ä¸ç¢ºå®Ÿæ€§æºã«é™å®šã•ã‚Œãªã„ã€‚

v5.6ã§ã¯ã€Hazeã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å†å®šç¾©ã™ã‚‹ï¼š

### 2.4.2 Haze ã®æ–°å®šç¾©ï¼ˆv5.6ï¼‰

**Haze ã¯è¨­è¨ˆè€…ãŒè¨­å®šã™ã‚‹çŸ¥è¦šè§£åƒåº¦ã®ãƒ¡ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚**

$$
\text{Haze}[k] \in [0, 1]
$$

#### Haze ã®è¨­å®šæ–¹æ³•

##### (1) å›ºå®šãƒ¢ãƒ¼ãƒ‰ï¼ˆPhase 1-5ã§ä½¿ç”¨ï¼‰

$$
\text{Haze}[k] = \text{const.} \quad \text{(e.g., 0.0, 0.3, 0.5, 0.7)}
$$

å…¨ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã‚’é€šã˜ã¦ä¸€å®šå€¤ã‚’ä½¿ç”¨ã€‚ç•°ãªã‚‹å›ºå®šå€¤ã§ã®æ¯”è¼ƒå®Ÿé¨“ã«ã‚ˆã‚Šã€Hazeã®åŠ¹æœã‚’æ¤œè¨¼ã™ã‚‹ã€‚

**æ³¨**: VAEè¨“ç·´ã¯ Haze=0.0 ã§å®Ÿæ–½ã—ã€å®Ÿè¡Œæ™‚ã«ã¯ä»»æ„ã®å›ºå®šå€¤ã‚’è¨­å®šå¯èƒ½ã€‚

##### (2) ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼ˆè¨­è¨ˆè€…åˆ¶å¾¡ï¼‰

ç’°å¢ƒçŠ¶æ…‹ã«å¿œã˜ã¦è¨­è¨ˆè€…ãŒäº‹å‰å®šç¾©ã—ãŸãƒ«ãƒ¼ãƒ«ã§è¨­å®šï¼š

$$
\text{Haze}[k] =
\begin{cases}
0.9 & \text{if } \rho[k] > 20 \text{ (è¶…æ··é›‘)} \\
0.6 & \text{if } \rho[k] > 10 \text{ (æ··é›‘)} \\
0.8 & \text{if } r_{\text{collision}}[k] > 0.8 \text{ (é«˜ãƒªã‚¹ã‚¯)} \\
0.2 & \text{otherwise (é€šå¸¸)}
\end{cases}
$$

ã“ã“ã§ã€$\rho[k]$ ã¯å±€æ‰€å¯†åº¦ã€$r_{\text{collision}}[k]$ ã¯è¡çªãƒªã‚¹ã‚¯ã€‚

##### (3) Self-Hazingãƒ¢ãƒ¼ãƒ‰ï¼ˆPhase 6ã§å®Ÿè£…äºˆå®šï¼‰â˜…å°†æ¥æ‹¡å¼µâ˜…

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªå¾‹çš„ã«æœ€é©Hazeã‚’å­¦ç¿’ï¼š

$$
\text{Haze}[k] = \pi_{\text{haze}}(\boldsymbol{h}[k])
$$

ã“ã“ã§ã€$\boldsymbol{h}[k]$ ã¯ä»¥ä¸‹ã®æƒ…å ±ã‚’å«ã‚€å±¥æ­´ãƒ™ã‚¯ãƒˆãƒ«ï¼š
- VAEä¸ç¢ºå®Ÿæ€§: $\sigma_z^2(y[k], u[k])$
- äºˆæ¸¬èª¤å·®å±¥æ­´: $\{e[k-T:k]\}$
- ã‚¿ã‚¹ã‚¯æˆåŠŸç‡: $\eta_{\text{success}}$
- è¡çªå±¥æ­´: $\{c[k-T:k]\}$

å­¦ç¿’æ‰‹æ³•:
- **Option 1**: å¼·åŒ–å­¦ç¿’ï¼ˆHazeé¸æŠã‚’è¡Œå‹•ç©ºé–“ã«è¿½åŠ ï¼‰
- **Option 2**: ãƒ¡ã‚¿å­¦ç¿’ï¼ˆMAMLç­‰ï¼‰
- **Option 3**: ãƒ™ã‚¤ã‚ºæœ€é©åŒ–

### 2.4.3 VAEä¸ç¢ºå®Ÿæ€§ $\sigma_z^2$ ã¨ã®é–¢ä¿‚ï¼ˆv5.6æ˜ç¢ºåŒ–ï¼‰

**é‡è¦**: v5.5ã§ã¯ Haze â‰¡ $\text{Agg}(\sigma_z^2)$ ã¨å®šç¾©ã—ã¦ã„ãŸãŒã€v5.6ã§ã¯ **Hazeã¨$\sigma_z^2$ã¯ç‹¬ç«‹** ã§ã‚ã‚‹ã€‚

| å¤‰æ•° | å®šç¾© | å½¹å‰² | åˆ¶å¾¡è€… |
|------|------|------|--------|
| $\sigma_z^2$ | VAEæ½œåœ¨ç©ºé–“ã®åˆ†æ•£ | VAEã®å†…éƒ¨å¤‰æ•° | VAEå­¦ç¿’ |
| Haze | çŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | Î²å¤‰èª¿ã®å…¥åŠ› | è¨­è¨ˆè€… or Self-Hazing |

**Phase 1-5**: VAEè¨“ç·´ã¯Haze=0ã€å®Ÿè¡Œæ™‚Hazeã¯å›ºå®šå€¤ï¼ˆ0.0, 0.3, 0.5, 0.7ã§ã®æ¯”è¼ƒå®Ÿé¨“ï¼‰ã€$\sigma_z^2$ã¯ãƒ­ã‚°ã®ã¿
**Phase 6**: Self-Hazingã§ $\sigma_z^2$ ã‚’å…¥åŠ›ã®ä¸€è¦ç´ ã¨ã—ã¦ä½¿ç”¨å¯èƒ½

---

## 2.5 å¾ªç’°ä¾å­˜ã®è§£æ¶ˆã¨å› æœé †åºï¼ˆv5.6ï¼‰

v5.6ã§ã¯ã€Surpriseã€Hazeã€Î²ã€SPMã®å› æœé–¢ä¿‚ãŒæ˜ç¢ºåŒ–ã•ã‚Œã‚‹ã€‚

### 2.5.1 å› æœãƒ•ãƒ­ãƒ¼

```
[Time k]
1. Haze[k] ã‚’å–å¾—ï¼ˆå›ºå®š or ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« or Self-Hazingï¼‰
2. Î²[k] = f_precision(Haze[k]) ã‚’è¨ˆç®—
3. SPM[k] ã‚’ç”Ÿæˆï¼ˆÎ²[k]ã§é›†ç´„ã®é‹­ã•ã‚’åˆ¶å¾¡ï¼‰
4. å€™è£œè¡Œå‹• u_i ã‚’ç”Ÿæˆ
5. å„ u_i ã«ã¤ã„ã¦:
   - F_goal(u_i) ã‚’è¨ˆç®—
   - F_safety(u_i) ã‚’è¨ˆç®—ï¼ˆVAEäºˆæ¸¬ä½¿ç”¨ï¼‰
   - S(u_i) ã‚’è¨ˆç®—ï¼ˆVAEå†æ§‹æˆèª¤å·®ï¼‰
   - F_total(u_i) = F_goal + F_safety + Î»_s * S
6. u*[k] = argmin F_total(u_i) ã‚’é¸æŠ
7. çŠ¶æ…‹æ›´æ–°

[Time k+1]
ï¼ˆç¹°ã‚Šè¿”ã—ï¼‰
```

### 2.5.2 å¾ªç’°ä¾å­˜ã®éå­˜åœ¨

v5.6ã§ã¯ã€ä»¥ä¸‹ã®ç†ç”±ã«ã‚ˆã‚Šå¾ªç’°ä¾å­˜ãŒå­˜åœ¨ã—ãªã„ï¼š

1. **Hazeã¯å¤–éƒ¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**: VAEã®å‡ºåŠ›ï¼ˆ$\sigma_z^2$ï¼‰ã«ä¾å­˜ã—ãªã„
2. **Surpriseã¯è¡Œå‹•è©•ä¾¡**: è¡Œå‹•é¸æŠã®çµæœã¨ã—ã¦ã®ã¿è¨ˆç®—ã•ã‚Œã‚‹
3. **Î²ã¯Hazeã‹ã‚‰ä¸€æ–¹å‘çš„ã«å°å‡º**: SPMç”Ÿæˆå‰ã«ç¢ºå®š

### 2.5.3 Self-Hazingã«ãŠã‘ã‚‹æ½œåœ¨çš„å¾ªç’°ï¼ˆPhase 6ï¼‰

Self-Hazingã§ã¯ã€ä»¥ä¸‹ã®å¾ªç’°ãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼š

```
Haze[k] â†’ Î²[k] â†’ SPM[k] â†’ u[k] â†’ Performance â†’ Haze[k+1]
```

ã“ã‚Œã¯ **ãƒ¡ã‚¿å­¦ç¿’** ã®æ çµ„ã¿ã§æ‰±ã‚ã‚Œã‚‹ã€‚Hazeã®æ›´æ–°ã¯è¡Œå‹•æ±ºå®šã‚ˆã‚Šã‚‚é…ã„æ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«ã§è¡Œã‚ã‚Œã‚‹ãŸã‚ã€å®Ÿè³ªçš„ãªå¾ªç’°ã¯ç™ºç”Ÿã—ãªã„ã€‚

---

## 2.6 æœ¬ç« ã®ã¾ã¨ã‚

æœ¬ç« ã§ã¯ã€EPH v5.6 ã®ç†è«–çš„åŸºç›¤ã‚’æ•´ç†ã—ãŸã€‚

**ä¸»è¦ãªç†è«–çš„è²¢çŒ®**:

1. **Surpriseçµ±åˆ**: Active Inferenceã®è¦è«‹ã§ã‚ã‚‹Surpriseã‚’ã€VAEå†æ§‹æˆèª¤å·®ã¨ã—ã¦å®šé‡åŒ–ã—ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«çµ±åˆã—ãŸ

2. **Hazeå†å®šç¾©**: Hazeã‚’è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å†å®šç¾©ã—ã€VAEä¸ç¢ºå®Ÿæ€§ï¼ˆ$\sigma_z^2$ï¼‰ã¨ã¯ç‹¬ç«‹ã—ãŸè¨­è¨ˆæ¬¡å…ƒã¨ã—ã¦æ‰±ã£ãŸ

3. **Precisionåˆ†é›¢**: æ¨è«–Precisionã¨çŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿Î²ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ã€ç†è«–çš„æ··ä¹±ã‚’å›é¿ã—ãŸ

4. **äºŒå±¤åˆ¶å¾¡**: Surpriseé§†å‹•ã®è¡Œå‹•é¸æŠå±¤ã¨ã€Hazeé§†å‹•ã®çŸ¥è¦šå¤‰èª¿å±¤ã‚’åˆ†é›¢ã—ãŸ

5. **Self-Hazingã®ç†è«–çš„æ çµ„ã¿**: å°†æ¥æ‹¡å¼µã¨ã—ã¦ã€è‡ªå¾‹çš„Hazeå­¦ç¿’ã®æ–¹å‘æ€§ã‚’ç¤ºã—ãŸ

**å› æœé–¢ä¿‚ã®æ•´ç†**:
- Haze â†’ Î² â†’ SPMç”Ÿæˆ
- SPM + Goal + VAE â†’ Actionå€™è£œç”Ÿæˆ
- Actionå€™è£œ â†’ Surpriseè¨ˆç®— â†’ æœ€é©Actioné¸æŠ

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€ç†è«–çš„å³å¯†æ€§ï¼ˆFEPæº–æ‹ ï¼‰ã¨å®Ÿè£…å¯èƒ½æ€§ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ï¼‰ã‚’ä¸¡ç«‹ã•ã›ãŸã€‚

---

# 3. æ‰‹æ³• (Methodology)

æœ¬ç« ã§ã¯ã€EPH v5.6ã®å…·ä½“çš„ãªå®Ÿè£…æ‰‹æ³•ã‚’è©³è¿°ã™ã‚‹ã€‚ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆã€çŸ¥è¦šè¡¨ç¾ï¼ˆSPMï¼‰ã€ä¸–ç•Œãƒ¢ãƒ‡ãƒ«ï¼ˆAction-Conditioned VAEï¼‰ã€Surpriseè¨ˆç®—ã€è¡Œå‹•ç”Ÿæˆã€Haze ã«åŸºã¥ãçŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡ã®é †ã«èª¬æ˜ã™ã‚‹ã€‚

---

## 3.1 ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆ (System Overview)

EPH v5.6 ã¯ã€ä»¥ä¸‹ã®äºŒå±¤åˆ¶å¾¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§æ§‹æˆã•ã‚Œã‚‹ï¼š

### 3.1.1 å…¨ä½“ãƒ•ãƒ­ãƒ¼

```
[çŸ¥è¦šå±¤ï¼šPerceptual Layer]
Raw Sensors â†’ SPM_raw â†’ Precision Î² (from Haze) â†’ SPM_modulated

[è¡Œå‹•å±¤ï¼šAction Layer]
SPM_modulated + Goal + VAE â†’ Action Candidates
  â†’ Evaluate F_goal + F_safety + Î»_s*Surprise
  â†’ Select u* = argmin F
  â†’ Execute
```

### 3.1.2 VAE ã®äºŒé‡ã®å½¹å‰²ï¼ˆv5.6ï¼‰

VAEã¯ä»¥ä¸‹ã®2ã¤ã®æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ï¼š

| æ©Ÿèƒ½ | å…¥åŠ› | å‡ºåŠ› | ç”¨é€” |
|------|------|------|------|
| **äºˆæ¸¬** | $(y[k], u[k])$ | $\hat{y}[k+1]$ | å®‰å…¨æ€§é … $F_{\text{safety}}$ |
| **å†æ§‹æˆ** | $(y[k], u[k])$ | $y_{\text{recon}}$ | Surpriseé … $S$ |

**é‡è¦**: VAEã®æ½œåœ¨ç©ºé–“ä¸ç¢ºå®Ÿæ€§ $\sigma_z^2$ ã¯ã€Phase 1-5ã§ã¯ç›´æ¥ä½¿ç”¨ã•ã‚Œãªã„ã€‚Phase 6ã®Self-Hazingã§åˆ©ç”¨å¯èƒ½ã€‚

### 3.1.3 è¡Œå‹•ç”ŸæˆçµŒè·¯ï¼ˆAction Generation Pathï¼‰

```
Goal x_g â”€â”€â”€â”€â”
             â”œâ”€â†’ F_goal(u)
u candidatesâ”€â”¤
             â”œâ”€â†’ F_safety(u) (via VAE prediction)
SPM[k] â”€â”€â”€â”€â”€â”€â”¤
             â””â”€â†’ S(u) (via VAE reconstruction)
                  â†“
              F_total = F_goal + F_safety + Î»_s*S
                  â†“
              u* = argmin F_total
```

### 3.1.4 çŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡çµŒè·¯ï¼ˆPerceptual Resolution Control Pathï¼‰

```
Hazeè¨­å®š â”€â”€â†’ Haze[k] â”€â”€â†’ Î²[k] = f_precision(Haze[k])
                           â†“
SPM_raw â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ apply_precision(SPM_raw, Î²) â”€â”€â†’ SPM[k]
```

**Hazeè¨­å®šã®3ãƒ¢ãƒ¼ãƒ‰**:
- Mode 1: å›ºå®šï¼ˆ0.5ï¼‰
- Mode 2: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå¯†åº¦ãƒ»ãƒªã‚¹ã‚¯ä¾å­˜ï¼‰
- Mode 3: Self-Hazingï¼ˆPhase 6ï¼‰

---

## 3.2 çŸ¥è¦šè¡¨ç¾ï¼šSaliency Polar Map (SPM)

### 3.2.1 SPM ã®æ¦‚è¦

SPMï¼ˆSaliency Polar Mapï¼‰ã¯ã€è‡ªå·±ä¸­å¿ƒçš„ãªæ¥µåº§æ¨™ã‚°ãƒªãƒƒãƒ‰ $(r, \theta)$ ä¸Šã§å®šç¾©ã•ã‚Œã‚‹ $16 \times 16 \times 3$ ã®ä¸‰æ¬¡å…ƒé…åˆ—ã§ã‚ã‚‹ã€‚3ã¤ã®ãƒãƒ£ãƒãƒ«ã¯ä»¥ä¸‹ã®æ„å‘³ã‚’æŒã¤ï¼š

- **Ch1 (Occupancy)**: å æœ‰å¯†åº¦
- **Ch2 (Proximity Saliency)**: è¿‘æ¥é¡•è‘—æ€§ï¼ˆsoft-maxã«ã‚ˆã‚‹é›†ç´„ï¼‰
- **Ch3 (Dynamic Collision Risk)**: å‹•çš„è¡çªå±é™ºæ€§

### 3.2.2 ãƒãƒ£ãƒãƒ«1ï¼šå æœ‰å¯†åº¦ (Occupancy)

å æœ‰å¯†åº¦ã¯ã€å„ã‚»ãƒ«å†…ã«å­˜åœ¨ã™ã‚‹ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°ã‚’æ­£è¦åŒ–ã—ãŸå€¤ã§ã‚ã‚‹ï¼š

$$
\text{SPM}_{\text{ch1}}[m, n] = \frac{N_{m,n}}{N_{\max}}
$$

- $N_{m,n}$: ã‚»ãƒ« $(m, n)$ å†…ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°
- $N_{\max}$: æ­£è¦åŒ–å®šæ•°

### 3.2.3 ãƒãƒ£ãƒãƒ«2ï¼šè¿‘æ¥é¡•è‘—æ€§ (Proximity Saliency) â˜…Î²å¤‰èª¿ã®å¯¾è±¡â˜…

è¿‘æ¥é¡•è‘—æ€§ã¯ã€å„ã‚»ãƒ«å†…ã®ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®è·é›¢ã‚’ soft-max é›†ç´„ã«ã‚ˆã‚Šçµ±åˆã™ã‚‹ï¼š

$$
\text{SPM}_{\text{ch2}}[m, n] =
\begin{cases}
\displaystyle
\frac{\sum_{i \in \mathcal{N}_{m,n}} w_i \exp(\beta \cdot \phi_i)}{\sum_{i \in \mathcal{N}_{m,n}} \exp(\beta \cdot \phi_i)} & \text{if } |\mathcal{N}_{m,n}| > 0 \\
0 & \text{otherwise}
\end{cases}
$$

ã“ã“ã§ï¼š
- $\mathcal{N}_{m,n}$: ã‚»ãƒ« $(m, n)$ ã«å¯¾å¿œã™ã‚‹ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé›†åˆ
- $w_i = 1 / (d_i + \epsilon)$: è·é›¢ã®é€†æ•°
- $\phi_i = -d_i$: è¿‘æ¥ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆè·é›¢ãŒè¿‘ã„ã»ã©é«˜ã„ï¼‰
- $\beta$: **Hazeã‹ã‚‰å°å‡ºã•ã‚Œã‚‹Precisionãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**

**Î²ã®åŠ¹æœ**:
- **é«˜Î²** (ä½Haze): æœ€ã‚‚è¿‘ã„éšœå®³ç‰©ã‚’å¼·èª¿ï¼ˆé‹­æ•ï¼‰
- **ä½Î²** (é«˜Haze): å…¨ã¦ã®éšœå®³ç‰©ã‚’å¹³å‡åŒ–ï¼ˆç²—è¦–åŒ–ï¼‰

**æ•°å¼è§£é‡ˆ**:
$$
\lim_{\beta \to \infty} \text{SPM}_{\text{ch2}}[m, n] = \max_{i \in \mathcal{N}_{m,n}} w_i \quad \text{(æœ€å¤§å€¤é¸æŠ)}
$$

$$
\lim_{\beta \to 0} \text{SPM}_{\text{ch2}}[m, n] = \frac{1}{|\mathcal{N}_{m,n}|} \sum_{i \in \mathcal{N}_{m,n}} w_i \quad \text{(å¹³å‡)}
$$

### 3.2.4 ãƒãƒ£ãƒãƒ«3ï¼šå‹•çš„è¡çªå±é™ºæ€§ (Dynamic Collision Risk)

Ch3ã¯ã€ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®é€Ÿåº¦ã‚’è€ƒæ…®ã—ãŸå‹•çš„ãªè¡çªãƒªã‚¹ã‚¯ã‚’è¡¨ç¾ã™ã‚‹ï¼š

$$
\text{SPM}_{\text{ch3}}[m, n] =
\frac{\sum_{i \in \mathcal{N}_{m,n}} r_i \exp(\beta \cdot \psi_i)}{\sum_{i \in \mathcal{N}_{m,n}} \exp(\beta \cdot \psi_i)}
$$

ã“ã“ã§ï¼š
- $r_i$: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ $i$ ã¨ã®è¡çªãƒªã‚¹ã‚¯
- $\psi_i = -\text{TTC}_i$: Time-to-Collision ã®é€†æ•°

è¡çªãƒªã‚¹ã‚¯ã¯ä»¥ä¸‹ã§å®šç¾©ï¼š

$$
r_i =
\begin{cases}
\displaystyle
\frac{1}{\text{TTC}_i + \epsilon} \cdot \max(0, \cos \theta_{\text{rel},i}) & \text{if TTC}_i < T_{\text{threshold}} \\
0 & \text{otherwise}
\end{cases}
$$

- $\theta_{\text{rel},i}$: ç›¸å¯¾é€Ÿåº¦ãƒ™ã‚¯ãƒˆãƒ«ã¨ä½ç½®ãƒ™ã‚¯ãƒˆãƒ«ã®ãªã™è§’
- $T_{\text{threshold}}$: TTCã®é–¾å€¤ï¼ˆä¾‹: 5ç§’ï¼‰

---

## 3.3 é›†ç´„æ¼”ç®—å­ Agg ã®å®šç¾©ï¼ˆv5.6æ˜ç¤ºï¼‰

v5.6ã§ã¯ã€é›†ç´„æ¼”ç®—å­ $\text{Agg}$ ã‚’ soft-max ã¨ã—ã¦æ˜ç¤ºçš„ã«å®šç¾©ã™ã‚‹ï¼š

$$
\text{Agg}_{\beta}(w_1, \ldots, w_N; \phi_1, \ldots, \phi_N)
=
\frac{\sum_{i=1}^N w_i \exp(\beta \cdot \phi_i)}{\sum_{i=1}^N \exp(\beta \cdot \phi_i)}
$$

ã“ã®æ¼”ç®—å­ã¯ã€$\beta$ ã«ã‚ˆã‚Šä»¥ä¸‹ã®é€£ç¶šçš„ãªè£œé–“ã‚’å®Ÿç¾ã™ã‚‹ï¼š

| Î² | å‹•ä½œ | è§£é‡ˆ |
|---|------|------|
| $\beta \to 0$ | ç®—è¡“å¹³å‡ | ç²—ã„çŸ¥è¦šï¼ˆå…¨è¦ç´ ã‚’å‡ç­‰ã«æ‰±ã†ï¼‰ |
| $\beta = 1$ | ãƒœãƒ«ãƒ„ãƒãƒ³é‡ã¿ | æ¨™æº–çš„ãªé‡ã¿ä»˜ãå¹³å‡ |
| $\beta \to \infty$ | maxæ¼”ç®—å­ | é‹­æ•ãªçŸ¥è¦šï¼ˆæœ€ã‚‚é¡•è‘—ãªè¦ç´ ã®ã¿ï¼‰ |

**è¨­è¨ˆä¸Šã®åˆ©ç‚¹**:
- å¾®åˆ†å¯èƒ½ï¼ˆå‹¾é…ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ãŒå¯èƒ½ï¼‰
- æ¸©åº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã®å¯¾å¿œãŒæ˜ç¢º
- çµ±è¨ˆåŠ›å­¦çš„è§£é‡ˆï¼ˆåˆ†é…é–¢æ•°ï¼‰

---

## 3.4 ä¸–ç•Œãƒ¢ãƒ‡ãƒ«ï¼šAction-Conditioned VAE ã«ã‚ˆã‚‹å°†æ¥ SPM äºˆæ¸¬ã¨Surpriseè¨ˆç®—ï¼ˆv5.6ï¼‰

### 3.4.1 VAE ã®æ§‹é€ ï¼ˆPattern Dï¼‰

v5.6ã§ã¯ã€Action-Dependent Encoder ã¨ Action-Conditioned Decoder ã‚’æŒã¤ Pattern D ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã™ã‚‹ã€‚

**è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®è¨­è¨ˆåŸå‰‡ï¼ˆv5.6.1ï¼‰**:
- **Haze = 0.0ï¼ˆæœ€é«˜è§£åƒåº¦ï¼‰** ã§åé›†ã—ãŸSPMãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’ä½¿ç”¨
- è¨“ç·´ãƒ‡ãƒ¼ã‚¿: $\{(y[k]^{\text{Haze}=0}, u[k], y[k+1]^{\text{Haze}=0})\}$ ãƒˆãƒªãƒ—ãƒ¬ãƒƒãƒˆ
- å®Ÿè¡Œæ™‚: ä»»æ„ã®Hazeå€¤ï¼ˆ0.0ã€œ0.9ï¼‰ã«åŸºã¥ã„ã¦ç”Ÿæˆã•ã‚ŒãŸSPMã‚’å…¥åŠ›

**è¨­è¨ˆæ„å›³**:
VAEã‚’æœ€é«˜è§£åƒåº¦SPMã§è¨“ç·´ã™ã‚‹ã“ã¨ã§ã€è©³ç´°ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ã•ã›ã‚‹ã€‚å®Ÿè¡Œæ™‚ã€è¨­è¨ˆè€…ãŒé«˜ã„Hazeå€¤ã‚’è¨­å®šã™ã‚‹ã¨ã€SPMç”Ÿæˆæ™‚ã«æƒ…å ±ãŒç²—è¦–åŒ–ã•ã‚Œã€çµæœã¨ã—ã¦å†æ§‹æˆèª¤å·®ï¼ˆSurpriseï¼‰ãŒå¢—åŠ ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

**å› æœã®æµã‚Œï¼ˆé‡è¦ï¼‰**:

$$
\text{Haze}[k] \xrightarrow{\text{è¨­è¨ˆè€…è¨­å®š}} \beta[k] \xrightarrow{\text{SPMç”Ÿæˆ}} y[k]^{\text{ç²—}} \xrightarrow{\text{VAEå…¥åŠ›}} S(\boldsymbol{u}) \text{ (å†æ§‹æˆèª¤å·®)}
$$

**æ³¨æ„**: VAEã¯Hazeã‚’è¨ˆç®—ã—ãªã„ã€‚Hazeã®åŠ¹æœã¯ã€SPMç”Ÿæˆæ™‚ã®Î²å¤‰èª¿ã‚’é€šã˜ã¦é–“æ¥çš„ã«Surpriseã«å½±éŸ¿ã™ã‚‹ã€‚

**å…¥åŠ›ãƒ»å‡ºåŠ›**:
- äºˆæ¸¬: $\hat{y}[k+1] = \text{Decoder}(z, u[k])$
- Surprise: $S(\boldsymbol{u}) = \|y[k] - \text{VAE}_{\text{recon}}(y[k], u)\|^2$ï¼ˆå†æ§‹æˆèª¤å·®ï¼‰

### 3.4.2 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ï¼ˆçŠ¶æ…‹ã¨è¡Œå‹•ã‹ã‚‰æ½œåœ¨åˆ†å¸ƒã‚’æ¨å®šï¼‰

$$
q_\phi(\boldsymbol{z} \mid \boldsymbol{y}[k], \boldsymbol{u}[k])
=
\mathcal{N}(\boldsymbol{\mu}_z(\boldsymbol{y}, \boldsymbol{u}), \mathrm{diag}(\boldsymbol{\sigma}_z^2(\boldsymbol{y}, \boldsymbol{u})))
$$

**å®Ÿè£…**:
```julia
# 1. SPMç‰¹å¾´æŠ½å‡º
y_features = CNN(y)  # (16,16,3) â†’ (512,)

# 2. Actionç‰¹å¾´æŠ½å‡º
u_features = MLP(u)  # (2,) â†’ (64,)

# 3. çµ±åˆ
joint_features = concat(y_features, u_features)  # (576,)

# 4. æ½œåœ¨åˆ†å¸ƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®š
Î¼_z, logÏƒ_z = MLP(joint_features)  # (576,) â†’ (32,), (32,)
```

**$\sigma_z^2$ ã®å½¹å‰²ï¼ˆv5.6ï¼‰**:
- VAEã®å†…éƒ¨å¤‰æ•°ï¼ˆå­¦ç¿’å¯¾è±¡ï¼‰
- Phase 1-5: ç›´æ¥ä½¿ç”¨ã›ãšã€ãƒ­ã‚°ã®ã¿è¨˜éŒ²
- Phase 6: Self-Hazingã®å…¥åŠ›å€™è£œã¨ã—ã¦åˆ©ç”¨å¯èƒ½

### 3.4.3 ãƒ‡ã‚³ãƒ¼ãƒ€ï¼ˆæ½œåœ¨å¤‰æ•° + æ“ä½œæŒ‡ä»¤å€¤ã‹ã‚‰å°†æ¥äºˆæ¸¬ï¼‰

$$
\hat{\boldsymbol{y}}[k+1] = f_{\text{dec}}(\boldsymbol{z}, \boldsymbol{u}[k])
$$

**å®Ÿè£…**:
```julia
# 1. æ½œåœ¨å¤‰æ•°ã‚’ç‰¹å¾´ã«å¤‰æ›
z_features = MLP(z)  # (32,) â†’ (256,)

# 2. Actionç‰¹å¾´
u_features = MLP(u)  # (2,) â†’ (64,)

# 3. çµ±åˆ
combined = concat(z_features, u_features)  # (320,)

# 4. SPMå†æ§‹æˆ
Å· = Deconv_CNN(combined)  # (320,) â†’ (16,16,3)
```

### 3.4.4 VAE ã®å­¦ç¿’ç›®çš„é–¢æ•°

$$
\mathcal{L}_{\text{VAE}} = \underbrace{\|\boldsymbol{y}[k+1] - \hat{\boldsymbol{y}}[k+1]\|^2}_{\text{äºˆæ¸¬èª¤å·®}} + \beta_{\text{KL}} \cdot \underbrace{D_{KL}[q(\boldsymbol{z}|\boldsymbol{y}, \boldsymbol{u}) \| \mathcal{N}(0, I)]}_{\text{æ­£å‰‡åŒ–}}
$$

- $\beta_{\text{KL}}$: KLé‡ã¿ï¼ˆä¾‹: 0.1 ã€œ 1.0ï¼‰

### 3.4.5 Pattern D ã®è¨­è¨ˆæ ¹æ‹ ï¼ˆv5.6æ˜ç¢ºåŒ–ï¼‰

Pattern Dï¼ˆAction-Dependent Encoderï¼‰ã‚’æ¡ç”¨ã™ã‚‹ç†ç”±ï¼š

1. **Counterfactual Surprise**: åŒä¸€çŠ¶æ…‹ $y[k]$ ã«å¯¾ã—ã¦ç•°ãªã‚‹è¡Œå‹• $u$ ã§ã®Surpriseã‚’è©•ä¾¡å¯èƒ½

2. **è¡Œå‹•ä¾å­˜ã®ä¸ç¢ºå®Ÿæ€§**: $\sigma_z^2(y, u)$ ã«ã‚ˆã‚Šã€Œã“ã®è¡Œå‹•ãŒã©ã‚Œã ã‘äºˆæ¸¬å›°é›£ã‹ã€ã‚’è¡¨ç¾

3. **Hazeã¨ã®åˆ†é›¢**: $\sigma_z^2$ ã¯VAEã®å†…éƒ¨å¤‰æ•°ã§ã‚ã‚Šã€Hazeã¨ã¯ç‹¬ç«‹ï¼ˆv5.6ã®è¨­è¨ˆåŸå‰‡ï¼‰

### 3.4.6 Haze=0è¨“ç·´ã®è¨­è¨ˆæ–¹é‡ï¼ˆv5.6.1ï¼‰

**è¨­è¨ˆåŸå‰‡**: VAEã‚’ **Haze=0ï¼ˆæœ€é«˜è§£åƒåº¦ã€Î²â†’âˆï¼‰** ã®SPMãƒ‡ãƒ¼ã‚¿ã§è¨“ç·´ã™ã‚‹ã€‚

**é‡è¦ãªæ³¨æ„**: VAEã¯Hazeã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚‰ãšã€Hazeã‚’æ¤œå‡ºãƒ»è¨ˆç®—ã—ãªã„ã€‚VAEã®å½¹å‰²ã¯**SPMäºˆæ¸¬ã¨Surpriseè¨ˆç®—ã®ã¿**ã§ã‚ã‚‹ã€‚

#### è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®è¨­è¨ˆ

è¨“ç·´ãƒ‡ãƒ¼ã‚¿: $\{(y[k]^{\text{Haze}=0}, u[k], y[k+1]^{\text{Haze}=0})\}$ ãƒˆãƒªãƒ—ãƒ¬ãƒƒãƒˆ

- **Haze=0**: æœ€é«˜è§£åƒåº¦ã®SPMï¼ˆÎ²â†’âˆã€é‹­æ•ãªé›†ç´„ï¼‰
- VAEã¯ã€Œè©³ç´°ãªSPMè¡¨ç¾ã€ã§ã®äºˆæ¸¬ã‚’å­¦ç¿’

#### å®Ÿè¡Œæ™‚ã®å‹•ä½œ

å®Ÿè¡Œæ™‚ã«ã¯ã€è¨­è¨ˆè€…ãŒè¨­å®šã—ãŸHazeå€¤ï¼ˆä¾‹: 0.3, 0.5, 0.7ï¼‰ã«å¿œã˜ã¦SPMãŒç”Ÿæˆã•ã‚Œã‚‹ï¼š

```
Hazeè¨­å®šï¼ˆè¨­è¨ˆè€…ï¼‰ â†’ Î²å¤‰èª¿ â†’ SPMç”Ÿæˆ â†’ VAEå…¥åŠ›
```

**å› æœãƒ•ãƒ­ãƒ¼ï¼ˆæ˜ç¢ºåŒ–ï¼‰**:

```
1. Haze[k] â† è¨­è¨ˆè€…ãŒè¨­å®šï¼ˆå›ºå®š or ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
2. Î²[k] = f_precision(Haze[k])
3. SPM[k] = generate_spm(..., Î²[k])  # Î²å¤‰èª¿é©ç”¨
4. VAEå…¥åŠ›: (SPM[k], u) â†’ äºˆæ¸¬Å·, Surprise S
```

**VAEã¯Hazeã‚’è¦‹ãªã„**: VAEã®å…¥åŠ›ã¯SPMã®ã¿ã§ã‚ã‚Šã€Hazeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯æ¸¡ã•ã‚Œãªã„ã€‚ã—ãŸãŒã£ã¦ã€VAEã® $\sigma_z^2$ ã¯Hazeã®é–¢æ•°ã§ã¯ãªãã€SPMã®ç‰¹æ€§ã«ä¾å­˜ã™ã‚‹ã€‚

#### Surpriseè¨ˆç®—

$$
S(\boldsymbol{u}) = \|\boldsymbol{y}[k] - \text{VAE}_{\text{recon}}(\boldsymbol{y}[k], \boldsymbol{u})\|^2
$$

HazeãŒé«˜ã„ â†’ SPMãŒç²—ã„ â†’ VAEã®å†æ§‹æˆèª¤å·®ãŒå¤§ãããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼ˆSPMã®æƒ…å ±é‡ãŒæ¸›ã‚‹ãŸã‚ï¼‰

**æ³¨æ„**: ã“ã‚Œã¯VAEãŒHazeã‚’è¨ˆç®—ã—ã¦ã„ã‚‹ã®ã§ã¯ãªãã€ç²—ã„SPMï¼ˆHazeã®çµæœï¼‰ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã£ãŸçµæœã§ã‚ã‚‹ã€‚

#### å®Ÿè£…ä¸Šã®åˆ©ç‚¹

1. **ãƒ‡ãƒ¼ã‚¿åé›†ã®ç°¡ç´ åŒ–**: å˜ä¸€æ¡ä»¶ï¼ˆHaze=0ï¼‰ã®ã¿ã§è¨“ç·´ãƒ‡ãƒ¼ã‚¿åé›†
2. **æ±åŒ–æ€§èƒ½**: è¨“ç·´æ™‚ã«æœ€ã‚‚è©³ç´°ãªæƒ…å ±ã‚’å­¦ç¿’ â†’ å®Ÿè¡Œæ™‚ã®åŠ£åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã«é ‘å¥
3. **è§£é‡ˆå¯èƒ½æ€§**: Surpriseå€¤ãŒã€Œè¨“ç·´æ™‚ã¨ã®æƒ…å ±å·®ã€ã¨ã—ã¦æ˜ç¢ºã«è§£é‡ˆå¯èƒ½

---

## 3.5 æ“ä½œæŒ‡ä»¤å€¤ã«é–¢ã™ã‚‹è¡Œå‹•ç”Ÿæˆï¼ˆv5.6: Surpriseçµ±åˆç‰ˆï¼‰

### 3.5.1 è¡Œå‹•ç”Ÿæˆã®ç›®çš„é–¢æ•°

v5.6ã§ã¯ã€æ‹¡å¼µè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æœ€å°åŒ–ã™ã‚‹è¡Œå‹•ã‚’é¸æŠã™ã‚‹ï¼š

$$
\boldsymbol{u}^*[k]
=
\arg\min_{\boldsymbol{u}}
\left[
F_{\text{goal}}(\boldsymbol{u}) + \lambda_{\text{safe}} \cdot F_{\text{safety}}(\boldsymbol{u}) + \lambda_s \cdot S(\boldsymbol{u})
\right]
$$

#### ç›®æ¨™é …

$$
F_{\text{goal}}(\boldsymbol{u}) = \|\hat{\boldsymbol{x}}[k+1](\boldsymbol{u}) - \boldsymbol{x}_g\|^2
$$

**è¨ˆç®—**: é‹å‹•ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚Š $\boldsymbol{u}$ ã‹ã‚‰ $\hat{\boldsymbol{x}}[k+1]$ ã‚’äºˆæ¸¬

#### å®‰å…¨æ€§é …

$$
F_{\text{safety}}(\boldsymbol{u}) = \max_{m,n} \hat{\boldsymbol{y}}_{m,n}^{\text{(ch3)}}[k+1](\boldsymbol{u})
$$

**è¨ˆç®—**: VAEã§ $(y[k], u) \to \hat{y}[k+1]$ ã‚’äºˆæ¸¬ã—ã€Ch3ï¼ˆå‹•çš„è¡çªãƒªã‚¹ã‚¯ï¼‰ã®æœ€å¤§å€¤ã‚’å–å¾—

#### Surpriseé …ï¼ˆv5.6ï¼‰

$$
S(\boldsymbol{u}) = \|\boldsymbol{y}[k] - \text{VAE}_{\text{recon}}(\boldsymbol{y}[k], \boldsymbol{u})\|^2
$$

**è¨ˆç®—æ‰‹é †**:
1. Encode: $\mu_z, \sigma_z = \text{Encoder}(y[k], u)$
2. $z = \mu_z$ ï¼ˆæ±ºå®šè«–çš„ã€å¹³å‡ã‚’ä½¿ç”¨ï¼‰
3. Decode: $y_{\text{recon}} = \text{Decoder}(z, u)$
4. $S = \text{MSE}(y[k], y_{\text{recon}})$

### 3.5.2 ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ï¼ˆv5.6å®Ÿè£…æ–¹é‡ï¼‰

å‹¾é…è¨ˆç®—ã®è¤‡é›‘ã•ã‚’å›é¿ã™ã‚‹ãŸã‚ã€Phase 1-5ã§ã¯ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ã‚’ä½¿ç”¨ï¼š

```julia
function compute_action_v56(agent, spm, vae, params)
    # 1. Baselineè¡Œå‹•
    u_baseline = compute_action_baseline(agent, spm)

    # 2. å€™è£œç”Ÿæˆ
    candidates = [u_baseline]
    for i in 1:9
        noise = randn(2) * 0.3
        push!(candidates, u_baseline + noise)
    end

    # 3. è©•ä¾¡
    best_u = u_baseline
    min_F = Inf

    for u in candidates
        u = clamp(u, -u_max, u_max)

        # ç›®æ¨™é …
        x_next = predict_position(agent, u)
        F_goal = norm(x_next - agent.goal)^2

        # å®‰å…¨é …ï¼ˆVAEäºˆæ¸¬ï¼‰
        Å· = predict_spm(vae, spm, u)
        F_safety = maximum(Å·[:,:,3])

        # Surpriseé …
        S = compute_surprise(vae, spm, u)

        # ç·åˆè©•ä¾¡
        F_total = F_goal + Î»_safe * F_safety + Î»_s * S

        if F_total < min_F
            min_F = F_total
            best_u = u
        end
    end

    return best_u
end
```

### 3.5.3 ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | æ¨å¥¨å€¤ | èª¿æ•´ç¯„å›² | å½¹å‰² |
|----------|--------|---------|------|
| $\lambda_{\text{safe}}$ | 10.0 | 5.0 ã€œ 20.0 | å®‰å…¨æ€§ã®é‡ã¿ |
| $\lambda_s$ | 1.0 | 0.1 ã€œ 5.0 | Surpriseã®é‡ã¿ |
| å€™è£œæ•° | 10 | 5 ã€œ 20 | ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ– |

---

## 3.6 Haze ã«åŸºã¥ãçŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡ï¼ˆÎ² å¤‰èª¿ï¼‰

### 3.6.1 Hazeã®å–å¾—

v5.6ã§ã¯ã€ä»¥ä¸‹ã®3ãƒ¢ãƒ¼ãƒ‰ã§Hazeã‚’å–å¾—ã™ã‚‹ï¼š

#### Mode 1: å›ºå®šHazeï¼ˆPhase 1-5ï¼‰

```julia
function get_haze_fixed()
    return 0.5  # å›ºå®šå€¤
end
```

#### Mode 2: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«Haze

```julia
function get_haze_scheduled(agent, environment)
    density = environment.local_density
    collision_risk = agent.collision_risk

    if density > 20
        return 0.9  # è¶…æ··é›‘ â†’ è¶…ç²—è¦–åŒ–
    elseif density > 10
        return 0.6  # æ··é›‘ â†’ ä¸­ç¨‹åº¦
    elseif collision_risk > 0.8
        return 0.8  # é«˜ãƒªã‚¹ã‚¯ â†’ ç²—è¦–åŒ–
    else
        return 0.2  # é€šå¸¸ â†’ é«˜è§£åƒåº¦
    end
end
```

#### Mode 3: Self-Hazingï¼ˆPhase 6ï¼‰

```julia
function get_haze_self_adaptive(agent, vae)
    # VAEä¸ç¢ºå®Ÿæ€§
    Î¼, logÏƒ = encode(vae, agent.spm, agent.last_action)
    Ïƒ_zÂ² = mean(exp.(2 .* logÏƒ))

    # äºˆæ¸¬èª¤å·®å±¥æ­´
    pred_error = agent.prediction_error_history

    # ã‚¿ã‚¹ã‚¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
    success_rate = agent.task_success_rate

    # ãƒ¡ã‚¿å­¦ç¿’ãƒ¢ãƒ‡ãƒ«
    haze = meta_learner(Ïƒ_zÂ², pred_error, success_rate)

    return haze
end
```

### 3.6.2 PrecisionÎ²ã¸ã®Mismatch


$$
\beta[k] = \frac{\beta_{\max}}{1 + \alpha \cdot \text{Haze}[k]}
$$

```julia
function precision_modulation(haze::Float64; Î²_max=10.0, Î±=1.0)
    Î² = Î²_max / (1.0 + Î± * haze)
    return clamp(Î², 1.0, Î²_max)
end
```

### 3.6.3 SPMç”Ÿæˆã¸ã®é©ç”¨

```julia
function generate_spm(agent, others, haze::Float64)
    # 1. Haze â†’ Î²
    Î² = precision_modulation(haze)

    # 2. Raw SPMç”Ÿæˆ
    spm_raw = compute_spm_raw(agent, others)

    # 3. Î²å¤‰èª¿ï¼ˆCh2, Ch3ã«é©ç”¨ï¼‰
    spm_ch2 = apply_softmax_aggregation(spm_raw_ch2, Î²)
    spm_ch3 = apply_softmax_aggregation(spm_raw_ch3, Î²)

    return cat(spm_raw_ch1, spm_ch2, spm_ch3, dims=3)
end
```

---

## 3.7 ç¾¤çŸ¥èƒ½ã¸ã®æ‹¡å¼µ (Swarm Intelligence Extension)

EPHã¯å˜ä½“ãƒ­ãƒœãƒƒãƒˆã«é™å®šã•ã‚Œãšã€ç¾¤çŸ¥èƒ½ã‚·ã‚¹ãƒ†ãƒ ã¸ã‚‚æ‹¡å¼µå¯èƒ½ã§ã‚ã‚‹ã€‚

### 3.7.1 å±€æ‰€Hazeã®å°å…¥

å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ $i$ ãŒç‹¬ç«‹ã—ãŸHaze $H_i[k]$ ã‚’æŒã¤ï¼š

$$
\beta_i[k] = f_{\text{precision}}(H_i[k])
$$

### 3.7.2 Self-Hazingã«ãŠã‘ã‚‹ç¾¤ã®å½±éŸ¿

Self-Hazingã§ã¯ã€è¿‘å‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çŠ¶æ…‹ã‚‚è€ƒæ…®å¯èƒ½ï¼š

$$
H_i[k] = \pi_{\text{haze}}(\boldsymbol{h}_i[k], \{\boldsymbol{h}_j[k] : j \in \mathcal{N}_i\})
$$

- $\mathcal{N}_i$: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ $i$ ã®è¿‘å‚é›†åˆ

### 3.7.3 è©•ä¾¡æŒ‡æ¨™

ç¾¤çŸ¥èƒ½æ‹¡å¼µã§ã¯ã€ä»¥ä¸‹ã®æŒ‡æ¨™ã‚’è¿½åŠ ï¼š
- **ç¾¤åˆ†æ–­ç‡**: é€£çµæˆåˆ†æ•°ã®å¤‰åŒ–
- **Lane Formation**: ãƒ¬ãƒ¼ãƒ³å½¢æˆã®ç§©åºãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- **Throughput**: å˜ä½æ™‚é–“ã‚ãŸã‚Šã®é€šéã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°

---

## 3.8 æœ¬ç« ã®ã¾ã¨ã‚

æœ¬ç« ã§ã¯ã€EPH v5.6ã®å…·ä½“çš„ãªå®Ÿè£…æ‰‹æ³•ã‚’è©³è¿°ã—ãŸã€‚

**ä¸»è¦ãªå®Ÿè£…è¦ç´ **:

1. **äºŒå±¤åˆ¶å¾¡**: Surpriseé§†å‹•ã®è¡Œå‹•å±¤ã¨ã€Hazeé§†å‹•ã®çŸ¥è¦šå±¤ã®åˆ†é›¢

2. **VAEã®äºŒé‡æ©Ÿèƒ½**: äºˆæ¸¬ï¼ˆå®‰å…¨æ€§è©•ä¾¡ï¼‰ã¨Surpriseè¨ˆç®—ï¼ˆè¡Œå‹•è©•ä¾¡ï¼‰

3. **Hazeè¨­å®šã®3ãƒ¢ãƒ¼ãƒ‰**: å›ºå®šã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€Self-Hazing

4. **ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–**: å‹¾é…è¨ˆç®—ã®è¤‡é›‘ã•ã‚’å›é¿

5. **SPMé›†ç´„ã®Î²å¤‰èª¿**: soft-maxã«ã‚ˆã‚‹çŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡

**å®Ÿè£…ã®éµ**:
- **VAEè¨“ç·´**: Haze=0ï¼ˆæœ€é«˜è§£åƒåº¦ï¼‰ã®SPMã§å®Ÿæ–½
- **Phase 1-5**: ç•°ãªã‚‹å›ºå®šHazeå€¤ï¼ˆ0.0, 0.3, 0.5, 0.7ï¼‰ã§æ¯”è¼ƒå®Ÿé¨“
- **Phase 6**: Self-Hazingã«ã‚ˆã‚‹è‡ªå¾‹åŒ–

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€ç†è«–çš„å³å¯†æ€§ã¨å®Ÿè£…å¯èƒ½æ€§ã‚’ä¸¡ç«‹ã•ã›ãŸã€‚

---

# 4. æ¤œè¨¼æˆ¦ç•¥ (Verification Strategy)

æœ¬ç« ã§ã¯ã€EPH v5.6ã®æ€§èƒ½ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®å®Ÿé¨“è¨­è¨ˆã€è©•ä¾¡æŒ‡æ¨™ã€æ¯”è¼ƒæ‰‹æ³•ã‚’å®šç¾©ã™ã‚‹ã€‚

---

## 4.1 æ¤œè¨¼ã‚·ãƒŠãƒªã‚ªã¨å‰ææ¡ä»¶

### 4.1.1 ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒ

**ç’°å¢ƒè¨­å®š**:
- ãƒˆãƒ¼ãƒ©ã‚¹ä¸–ç•Œï¼ˆå‘¨æœŸå¢ƒç•Œæ¡ä»¶ï¼‰
- 2DãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- é›¢æ•£æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆdt = 0.033ç§’ã€30 FPSï¼‰

**ã‚·ãƒŠãƒªã‚ª**:
1. **Scramble Crossing**: 4ã‚°ãƒ«ãƒ¼ãƒ—ãŒäº¤å·®ç‚¹ã§äº¤å·®
2. **Corridor**: åŒæ–¹å‘å¯¾é¢é€šè¡Œï¼ˆå¹…4-6mï¼‰

### 4.1.2 æ··é›‘åº¦ã®æ“ä½œçš„å®šç¾©

æ··é›‘åº¦ $\rho$ ã‚’ä»¥ä¸‹ã§å®šç¾©ï¼š

$$
\rho = \frac{N_{\text{agents}}}{A_{\text{area}}}
$$

å®Ÿé¨“ã§ã¯ä»¥ä¸‹ã®å¯†åº¦ã‚’ä½¿ç”¨ï¼š
- $\rho \in \{5, 10, 15, 20, 25\}$ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ/ã‚¨ãƒªã‚¢

### 4.1.3 å­¦ç¿’ã¨è©•ä¾¡ã®åˆ†é›¢ï¼ˆå†ç¾æ€§ãƒ»ä¸€èˆ¬åŒ–ã®å‰æï¼‰

**ãƒ‡ãƒ¼ã‚¿åˆ†å‰²**:
- **Train**: å¯†åº¦ 5, 10, 15ï¼ˆã‚·ãƒ¼ãƒ‰ 1-3ï¼‰
- **Val**: å¯†åº¦ 5, 10, 15ï¼ˆã‚·ãƒ¼ãƒ‰ 4ï¼‰
- **Test IID**: å¯†åº¦ 5, 10, 15ï¼ˆã‚·ãƒ¼ãƒ‰ 5ï¼‰
- **Test OOD**: å¯†åº¦ 20, 25ï¼ˆã‚·ãƒ¼ãƒ‰ 1ï¼‰

### 4.1.4 OODï¼ˆæœªçŸ¥æ¡ä»¶ï¼‰è©•ä¾¡

ä»¥ä¸‹ã®3ç¨®é¡ã®OODæ¡ä»¶ã‚’è©•ä¾¡ï¼š
1. **æœªçŸ¥æ··é›‘åº¦**: å¯†åº¦20, 25
2. **æœªçŸ¥ä»–è€…ãƒ¢ãƒ‡ãƒ«**: å­¦ç¿’æ™‚ã¨ç•°ãªã‚‹è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³
3. **è¦³æ¸¬ãƒã‚¤ã‚º**: SPMæ§‹ç¯‰æ™‚ã®ãƒã‚¤ã‚ºä»˜åŠ 

---

## 4.2 è©•ä¾¡æŒ‡æ¨™ (Evaluation Metrics)

### 4.2.1 Primary Outcomeï¼šFreezing Rate

**å®šç¾©**:

$$
\text{Freezing Rate} = \frac{N_{\text{freeze}}}{N_{\text{agents}}}
$$

ã“ã“ã§ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™æ™‚Freezingã¨åˆ¤å®šï¼š

$$
\|\dot{\boldsymbol{x}}[k]\| < \epsilon_v \quad \text{for } t > T_{\text{freeze}}
$$

- $\epsilon_v = 0.1$ m/sï¼ˆé€Ÿåº¦é–¾å€¤ï¼‰
- $T_{\text{freeze}} = 2.0$ ç§’ï¼ˆç¶™ç¶šæ™‚é–“é–¾å€¤ï¼‰

**ç›®æ¨™**: EPH Freezing Rate < Baseline Freezing Rateï¼ˆçµ±è¨ˆçš„æœ‰æ„å·®ï¼‰

### 4.2.2 Secondary Outcomes

| æŒ‡æ¨™ | å®šç¾© | ç›®æ¨™ |
|------|------|------|
| **Success Rate** | ã‚´ãƒ¼ãƒ«åˆ°é”ç‡ | > 80% |
| **Collision Rate** | è¡çªç™ºç”Ÿç‡ | < 20% |
| **Path Efficiency** | ç›´ç·šè·é›¢ / å®ŸçµŒè·¯é•· | > 0.7 |
| **Jerk** | $\|\|\ddot{\boldsymbol{u}}\|\|$ ã®æ™‚é–“å¹³å‡ | ä½ã„ã»ã©è‰¯ |
| **Min TTC** | Time-to-Collisionã®æœ€å°å€¤ | > 1.0ç§’ |
| **Throughput** | å˜ä½æ™‚é–“ã‚ãŸã‚Šã®é€šéæ•° | é«˜ã„ã»ã©è‰¯ |

---

## 4.3 æ¯”è¼ƒæ‰‹æ³•ï¼ˆBaselinesï¼‰

### 4.3.1 ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒ‡ã‚£

| æ¡ä»¶ID | Surprise | Haze | Î² | èª¬æ˜ |
|--------|---------|------|---|------|
| **A0_BASELINE** | âŒ | 0.0 | 10.0 | æ¨™æº–FEPã€å›ºå®šé«˜ç²¾åº¦ |
| **A1_HAZE_ONLY** | âŒ | 0.5 | å¤‰èª¿ | Hazeå¤‰èª¿ã®ã¿ |
| **A2_SURPRISE_ONLY** | âœ… | 0.0 | 10.0 | Surpriseé§†å‹•ã€Î²å›ºå®š |
| **A3_EPH_V56** | âœ… | 0.5 | å¤‰èª¿ | **ææ¡ˆæ‰‹æ³•ï¼ˆä¸¡æ–¹æœ‰åŠ¹ï¼‰** |

### 4.3.2 å¤å…¸çš„æ‰‹æ³•ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

- **Social Force Model**: Helbing et al. (2000)
- **ORCA**: van den Berg et al. (2011)

### 4.3.3 ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬åˆ¶å¾¡ç³»ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

- **Robust MPC**: æœ€æ‚ªã‚±ãƒ¼ã‚¹è¨­è¨ˆ
- **Tube MPC**: ä¸ç¢ºå®Ÿæ€§é›†åˆ

### 4.3.4 å­¦ç¿’ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

- **SA-CADRL**: Chen et al. (2017)
- **SAC**: Soft Actor-Critic

---

## 4.4 çµ±è¨ˆçš„æ¤œè¨¼

### 4.4.1 æ¤œå®šæ‰‹æ³•

**Mann-Whitney U Test**: A3 vs A0ã®Freeing Rateæ¯”è¼ƒ

$$
H_0: \text{median}(\text{FR}_{\text{A3}}) = \text{median}(\text{FR}_{\text{A0}})
$$

$$
H_1: \text{median}(\text{FR}_{\text{A3}}) < \text{median}(\text{FR}_{\text{A0}})
$$

æœ‰æ„æ°´æº–: $\alpha = 0.05$

### 4.4.2 åŠ¹æœé‡

Cohen's d:

$$
d = \frac{\bar{x}_{\text{A3}} - \bar{x}_{\text{A0}}}{\sqrt{\frac{s_{\text{A3}}^2 + s_{\text{A0}}^2}{2}}}
$$

è§£é‡ˆ:
- $|d| < 0.2$: å°
- $0.2 \leq |d| < 0.5$: ä¸­
- $|d| \geq 0.5$: å¤§

---

## 4.5 æœ¬ç« ã®ã¾ã¨ã‚

æ¤œè¨¼æˆ¦ç•¥ã®ãƒã‚¤ãƒ³ãƒˆ:

1. **Primary Outcome**: Freezing Rateï¼ˆEPHã®æ ¸å¿ƒç›®æ¨™ï¼‰
2. **ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: Surpriseã€Hazeã®å€‹åˆ¥åŠ¹æœã‚’åˆ†é›¢è©•ä¾¡
3. **OODè©•ä¾¡**: æœªå­¦ç¿’æ¡ä»¶ã§ã®é ‘å¥æ€§ç¢ºèª
4. **çµ±è¨ˆçš„å³å¯†æ€§**: æœ‰æ„å·®æ¤œå®šã¨åŠ¹æœé‡

---

# 5. é–¢é€£ç ”ç©¶ (Related Work)

æœ¬ç« ã§ã¯ã€EPH v5.6ã®ç†è«–çš„ãƒ»æŠ€è¡“çš„èƒŒæ™¯ã¨ãªã‚‹é–¢é€£ç ”ç©¶ã‚’æ•´ç†ã™ã‚‹ã€‚

---

## 5.1 è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ã¨ Active Inference

**Friston (2010)** ã¯ã€ç”Ÿç‰©ã®çŸ¥è¦šã¨è¡Œå‹•ã‚’çµ±ä¸€çš„ã«èª¬æ˜ã™ã‚‹è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFEPï¼‰ã‚’æå”±ã—ãŸã€‚FEPã§ã¯ã€ç”Ÿç‰©ã¯æ„Ÿè¦šå…¥åŠ›ã® **Surprise** ã‚’æœ€å°åŒ–ã™ã‚‹ã‚ˆã†ã«è¡Œå‹•ã™ã‚‹ã€‚

**Active Inference** (Friston et al., 2015) ã¯ã€FEPã®è¡Œå‹•ç”Ÿæˆã¸ã®å¿œç”¨ã§ã‚ã‚Šã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ **Expected Free Energy (EFE)** ã‚’æœ€å°åŒ–ã™ã‚‹ï¼š

$$
G(\boldsymbol{u}) = \mathbb{E}[-\log p(\boldsymbol{o}|\boldsymbol{s}, \boldsymbol{u})] + D_{KL}[q(\boldsymbol{s}|\boldsymbol{o}, \boldsymbol{u}) \| p(\boldsymbol{s}|\boldsymbol{u})]
$$

æœ¬ç ”ç©¶ã¯ã€ã“ã®Surpriseé …ã‚’ **VAEå†æ§‹æˆèª¤å·®** ã¨ã—ã¦å·¥å­¦çš„ã«å®Ÿè£…ã—ãŸåˆã®è©¦ã¿ã§ã‚ã‚‹ã€‚

## 5.2 ä¸ç¢ºå®Ÿæ€§ã®åˆ†é¡ã¨æ¨å®šæ‰‹æ³•

ä¸ç¢ºå®Ÿæ€§ã¯å¤§ãã **ã‚¨ãƒ”ã‚¹ãƒ†ãƒŸãƒƒã‚¯ä¸ç¢ºå®Ÿæ€§**ï¼ˆçŸ¥è­˜ä¸è¶³ï¼‰ã¨ **ã‚¢ãƒ¬ã‚¢ãƒˆãƒªãƒƒã‚¯ä¸ç¢ºå®Ÿæ€§**ï¼ˆæœ¬è³ªçš„ãƒ©ãƒ³ãƒ€ãƒ æ€§ï¼‰ã«åˆ†é¡ã•ã‚Œã‚‹ (Kendall & Gal, 2017)ã€‚

æœ¬ç ”ç©¶ã§ã¯ã€Hazeã‚’ã“ã‚Œã‚‰ã®ä¸ç¢ºå®Ÿæ€§ã«é™å®šã›ãšã€**è¨­è¨ˆè€…ãŒåˆ¶å¾¡å¯èƒ½ãªãƒ¡ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** ã¨ã—ã¦æ‰±ã†ç‚¹ãŒç‰¹å¾´ã§ã‚ã‚‹ã€‚

## 5.3 ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¨è¡çªå›é¿æ‰‹æ³•

### 5.3.1 å¤å…¸çš„ãƒ¢ãƒ‡ãƒ«

- **Social Force Model** (Helbing et al., 2000): äººé–“ç¾¤é›†ã®å‹•åŠ›å­¦ãƒ¢ãƒ‡ãƒ«
- **ORCA** (van den Berg et al., 2011): æœ€é©ç›¸äº’è¡çªå›é¿

ã“ã‚Œã‚‰ã®æ‰‹æ³•ã¯ä¸ç¢ºå®Ÿæ€§ã‚’æ˜ç¤ºçš„ã«æ‰±ã‚ãªã„ã€‚

### 5.3.2 ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬åˆ¶å¾¡ï¼ˆMPCï¼‰

**Robust MPC** ã¯æœ€æ‚ªã‚±ãƒ¼ã‚¹è¨­è¨ˆã«ã‚ˆã‚Šä¸ç¢ºå®Ÿæ€§ã«å¯¾å‡¦ã™ã‚‹ãŒã€éåº¦ã«ä¿å®ˆçš„ã¨ãªã‚ŠFreezingã‚’å¼•ãèµ·ã“ã—ã‚„ã™ã„ã€‚

æœ¬ç ”ç©¶ã¯ã€Surpriseã«ã‚ˆã‚‹è¡Œå‹•è©•ä¾¡ã¨Hazeã«ã‚ˆã‚‹çŸ¥è¦šå¤‰èª¿ã«ã‚ˆã‚Šã€ä¿å®ˆæ€§ã¨æŸ”è»Ÿæ€§ã®ãƒãƒ©ãƒ³ã‚¹ã‚’å®Ÿç¾ã™ã‚‹ã€‚

## 5.4 å­¦ç¿’ãƒ™ãƒ¼ã‚¹æ‰‹æ³•ã¨æ¸©åº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

**Entropy-regularized RL** (Haarnoja et al., 2018) ã¯ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼é …ã«ã‚ˆã‚Šæ¢ç´¢ã‚’ä¿ƒé€²ã™ã‚‹ã€‚ã—ã‹ã—ã€ã“ã‚Œã¯è¡Œå‹•åˆ†å¸ƒã®å¤šæ§˜æ€§ã‚’åˆ¶å¾¡ã™ã‚‹ã‚‚ã®ã§ã‚ã‚Šã€çŸ¥è¦šè§£åƒåº¦ã®åˆ¶å¾¡ã§ã¯ãªã„ã€‚

æœ¬ç ”ç©¶ã®Hazeã¯ã€è¡Œå‹•å±¤ã§ã¯ãªã **çŸ¥è¦šå±¤** ã«ä»‹å…¥ã™ã‚‹ç‚¹ã§æœ¬è³ªçš„ã«ç•°ãªã‚‹ã€‚

## 5.5 çŸ¥è¦šè¡¨ç¾ã¨æ¥µåº§æ¨™è¡¨ç¾

**Saliency Polar Map (SPM)** ã¯ã€è‡ªå·±ä¸­å¿ƒçš„ãªæ¥µåº§æ¨™ã‚°ãƒªãƒƒãƒ‰ã§ã‚ã‚Šã€ãƒ­ãƒœãƒƒãƒˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã§åºƒãä½¿ç”¨ã•ã‚Œã‚‹ (Chen et al., 2017)ã€‚

æœ¬ç ”ç©¶ã®æ–°è¦æ€§ã¯ã€SPMã®é›†ç´„ã®é‹­ã•ã‚’ **Haze** ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚Šå¤‰èª¿å¯èƒ½ã¨ã™ã‚‹ã“ã¨ã§ã€çŸ¥è¦šè§£åƒåº¦ã‚’åˆ¶å¾¡å¯èƒ½ãªæ§‹é€ ã‚’å®Ÿç¾ã—ãŸç‚¹ã«ã‚ã‚‹ã€‚Phase 1-5ã§ã¯Hazeã¯å›ºå®šå€¤ã€Phase 6ã®Self-Hazingã§è‡ªå¾‹çš„é©å¿œãŒå¯èƒ½ã¨ãªã‚‹ã€‚

## 5.6 æœ¬ç« ã®ã¾ã¨ã‚

EPH v5.6ã¯ã€ä»¥ä¸‹ã®ç‚¹ã§æ—¢å­˜ç ”ç©¶ã¨å·®åˆ¥åŒ–ã•ã‚Œã‚‹ï¼š

1. **Active Inference ã®å·¥å­¦çš„å®Ÿè£…**: Surpriseã‚’æ˜ç¤ºçš„ã«çµ±åˆ
2. **Haze ã®è¨­è¨ˆåŸç†**: VAEä¸ç¢ºå®Ÿæ€§ã¨ã¯ç‹¬ç«‹ã—ãŸè¨­è¨ˆæ¬¡å…ƒ
3. **äºŒå±¤åˆ¶å¾¡**: è¡Œå‹•å±¤ã¨çŸ¥è¦šå±¤ã®åˆ†é›¢

---

# 6. è­°è«–ã¨é™ç•Œ (Discussion and Limitations)

æœ¬ç« ã§ã¯ã€EPH v5.6ã®ç†è«–çš„æ„ç¾©ã€é™ç•Œã€å°†æ¥å±•æœ›ã‚’è­°è«–ã™ã‚‹ã€‚

---

## 6.1 Freezing æŠ‘åˆ¶ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«é–¢ã™ã‚‹è€ƒå¯Ÿ

EPH v5.6ã¯ã€ä»¥ä¸‹ã®2ã¤ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«ã‚ˆã‚ŠFreezingã‚’æŠ‘åˆ¶ã™ã‚‹ï¼š

### (1) Surpriseæœ€å°åŒ–

SurpriseãŒé«˜ã„è¡Œå‹•ï¼ˆOODã€æœªå­¦ç¿’ï¼‰ã‚’å›é¿ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ **é¦´æŸ“ã¿ã®ã‚ã‚‹è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³** ã‚’é¸å¥½ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€äºˆæ¸¬å›°é›£ãªçŠ¶æ³ã§ã‚‚å®‰å®šã—ãŸè¡Œå‹•ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚

### (2) Hazeå¤‰èª¿

é«˜Hazeï¼ˆä½Î²ï¼‰ã§ã¯ã€SPMã®é›†ç´„ãŒç²—è¦–åŒ–ã•ã‚Œã€å±€æ‰€çš„ãªéšœå®³ç‰©ã¸ã®éå‰°åå¿œãŒæŠ‘åˆ¶ã•ã‚Œã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã€Œç›®ã®å‰ã®éšœå®³ç‰©ã«å›ºåŸ·ã—ã¦å‹•ã‘ãªããªã‚‹ã€ç¾è±¡ãŒå›é¿ã•ã‚Œã‚‹ã€‚

---

## 6.2 ä¸ç¢ºå®Ÿæ€§ã®è§£é‡ˆã¨ç†è«–çš„ä½ç½®ä»˜ã‘

v5.6ã§ã¯ã€ä¸ç¢ºå®Ÿæ€§ã‚’ä»¥ä¸‹ã®2ã¤ã®ç‹¬ç«‹ã—ãŸæ¦‚å¿µã¨ã—ã¦æ‰±ã†ï¼š

| æ¦‚å¿µ | å®šç¾© | åˆ¶å¾¡è€… | å½¹å‰² |
|------|------|--------|------|
| **Surprise** | äºˆæ¸¬å›°é›£åº¦ | VAEå­¦ç¿’ | è¡Œå‹•è©•ä¾¡ |
| **Haze** | çŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | è¨­è¨ˆè€… or Self-Hazing | Î²å¤‰èª¿ |

ã“ã®åˆ†é›¢ã«ã‚ˆã‚Šã€ç†è«–çš„æ˜ç¢ºæ€§ã¨å·¥å­¦çš„æŸ”è»Ÿæ€§ã‚’ä¸¡ç«‹ã•ã›ãŸã€‚

---

## 6.3 Precision åˆ†é›¢è¨­è¨ˆã®æ„ç¾©

å¾“æ¥ã®FEPå®Ÿè£…ã§ã¯ã€PrecisionãŒã€Œæ¨è«–ã®é‡ã¿ã€ã¨ã€ŒçŸ¥è¦šã®é‹­ã•ã€ã®ä¸¡æ–¹ã‚’æš—é»™çš„ã«æ‹…ã£ã¦ã„ãŸã€‚v5.6ã§ã¯ã€ä»¥ä¸‹ã®æ˜ç¢ºãªåˆ†é›¢ã‚’è¡Œã£ãŸï¼š

- **æ¨è«–Precision**: ç†è«–çš„æ¦‚å¿µï¼ˆå›ºå®šå€¤ï¼‰
- **çŸ¥è¦šè§£åƒåº¦Î²**: å®Ÿè£…ä¸Šã®åˆ¶å¾¡å¤‰æ•°ï¼ˆHazeã‹ã‚‰å°å‡ºï¼‰

ã“ã®åˆ†é›¢ã¯ã€ç†è«–ã¨å®Ÿè£…ã®å¯¾å¿œé–¢ä¿‚ã‚’æ˜ç¢ºåŒ–ã—ã€å·¥å­¦çš„è¨­è¨ˆã®è‡ªç”±åº¦ã‚’é«˜ã‚ã‚‹ã€‚

---

## 6.4 Self-Hazingã®å±•æœ›ï¼ˆPhase 6ï¼‰

Self-Hazingã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªå¾‹çš„ã«æœ€é©Hazeã‚’å­¦ç¿’ã™ã‚‹æ©Ÿèƒ½ã§ã‚ã‚‹ã€‚ã“ã‚Œã¯ **ãƒ¡ã‚¿å­¦ç¿’**ï¼ˆå­¦ç¿’ã®å­¦ç¿’ï¼‰ã«ç›¸å½“ã—ã€ä»¥ä¸‹ã®åˆ©ç‚¹ã‚’æŒã¤ï¼š

- è¨­è¨ˆè€…ã®ä»‹å…¥ã‚’æ¸›ã‚‰ã™
- æœªçŸ¥ç’°å¢ƒã¸ã®é©å¿œèƒ½åŠ›
- ã‚¿ã‚¹ã‚¯ä¾å­˜ã®æœ€é©åŒ–

å®Ÿè£…æ‰‹æ³•:
- å¼·åŒ–å­¦ç¿’ï¼ˆHazeé¸æŠã‚’è¡Œå‹•ç©ºé–“ã«è¿½åŠ ï¼‰
- ãƒ¡ã‚¿å­¦ç¿’ï¼ˆMAMLç­‰ï¼‰
- ãƒ™ã‚¤ã‚ºæœ€é©åŒ–

---

## 6.5 é™ç•Œã¨å¤±æ•—ãƒ¢ãƒ¼ãƒ‰

### 6.5.1 VAEå­¦ç¿’ã®å¤±æ•—

VAEã®äºˆæ¸¬ç²¾åº¦ãŒä¸ååˆ†ãªå ´åˆã€SurpriseãŒæ­£ã—ãè¨ˆç®—ã•ã‚Œãšã€è¡Œå‹•é¸æŠãŒä¸é©åˆ‡ã«ãªã‚‹ã€‚

**å¯¾ç­–**: Phase 3ã®å³æ ¼ãªæ¤œè¨¼åŸºæº–ï¼ˆCounterfactual Success Rate > 70%ï¼‰

### 6.5.2 ã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ã®é™ç•Œ

å€™è£œæ•°ãŒå°‘ãªã„å ´åˆã€çœŸã®æœ€é©è¡Œå‹•ã‚’è¦‹é€ƒã™å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

**å¯¾ç­–**: å€™è£œæ•°ã‚’10ã€œ20ç¨‹åº¦ã«è¨­å®šã€Phase 6ã§å‹¾é…ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ã‚’æ¤œè¨

### 6.5.3 è¨ˆç®—ã‚³ã‚¹ãƒˆ

Surpriseè¨ˆç®—ã«ã¯ VAE Forward Pass ãŒå¿…è¦ã§ã‚ã‚Šã€è¨ˆç®—ã‚³ã‚¹ãƒˆãŒå¢—åŠ ã™ã‚‹ã€‚

**å¯¾ç­–**: GPUä½¿ç”¨ã€å€™è£œæ•°ã®åˆ¶é™ã€è»½é‡VAEã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

---

## 6.6 ä»Šå¾Œã®å±•æœ›

### 6.6.1 å®Ÿç’°å¢ƒå®Ÿé¨“

ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¤œè¨¼å¾Œã€å®Ÿãƒ­ãƒœãƒƒãƒˆã§ã®æ¤œè¨¼ã‚’å®Ÿæ–½äºˆå®šã€‚

### 6.6.2 Self-Hazingã®å®Ÿè£…ï¼ˆPhase 6ï¼‰

ãƒ¡ã‚¿å­¦ç¿’ã«ã‚ˆã‚‹Hazeã®è‡ªå¾‹çš„æœ€é©åŒ–ã€‚

### 6.6.3 ç¾¤çŸ¥èƒ½ã¸ã®æ‹¡å¼µ

å±€æ‰€Hazeã«ã‚ˆã‚‹åˆ†æ•£å‹åˆ¶å¾¡ã®å®Ÿç¾ã€‚

---

## 6.7 æœ¬ç« ã®ã¾ã¨ã‚

EPH v5.6ã¯ã€Active Inferenceã®Surpriseæœ€å°åŒ–ã¨ã€Hazeã«ã‚ˆã‚‹çŸ¥è¦šè§£åƒåº¦åˆ¶å¾¡ã‚’çµ±åˆã™ã‚‹ã“ã¨ã§ã€FreezingæŠ‘åˆ¶ã¨ã„ã†å®Ÿç”¨çš„èª²é¡Œã«ç†è«–çš„æ ¹æ‹ ã‚’ä¸ãˆãŸã€‚

Self-Hazingã¨ã„ã†å°†æ¥å±•æœ›ã«ã‚ˆã‚Šã€è¨­è¨ˆè€…åˆ¶å¾¡ã‹ã‚‰è‡ªå¾‹åˆ¶å¾¡ã¸ã®é€²åŒ–ãƒ‘ã‚¹ã‚’ç¤ºã—ãŸã€‚

---

# 7. çµè«– (Conclusion)

æœ¬ç ”ç©¶ã§ã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFEPï¼‰ãŠã‚ˆã³ Active Inference ã«åŸºã¥ãäºŒå±¤åˆ¶å¾¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ **Emergent Perceptual Haze (EPH) v5.6** ã‚’ææ¡ˆã—ãŸã€‚

## ä¸»è¦ãªè²¢çŒ®

1. **Surpriseçµ±åˆ**: Active Inferenceã®ç†è«–çš„è¦è«‹ã§ã‚ã‚‹Surpriseã‚’ã€VAEå†æ§‹æˆèª¤å·®ã¨ã—ã¦å®šé‡åŒ–ã—ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«æ˜ç¤ºçš„ã«çµ„ã¿è¾¼ã‚“ã 

2. **Hazeè¨­è¨ˆåŸç†**: Hazeã‚’è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å†å®šç¾©ã—ã€VAEä¸ç¢ºå®Ÿæ€§ã¨ã¯ç‹¬ç«‹ã—ãŸè¨­è¨ˆæ¬¡å…ƒã¨ã—ã¦æ‰±ã£ãŸ

3. **äºŒå±¤åˆ¶å¾¡**: Surpriseé§†å‹•ã®è¡Œå‹•å±¤ã¨ã€Hazeé§†å‹•ã®çŸ¥è¦šå±¤ã‚’åˆ†é›¢ã—ãŸ

4. **Precisionåˆ†é›¢**: æ¨è«–Precisionã¨çŸ¥è¦šè§£åƒåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿Î²ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ã€ç†è«–çš„æ··ä¹±ã‚’å›é¿ã—ãŸ

5. **Self-Hazingã®æ çµ„ã¿**: å°†æ¥æ‹¡å¼µã¨ã—ã¦ã€è‡ªå¾‹çš„Hazeå­¦ç¿’ã®ç†è«–çš„åŸºç›¤ã‚’æç¤ºã—ãŸ

## å®Ÿè£…æˆ¦ç•¥

- **Phase 1-3**: VAEå­¦ç¿’ãƒ»æ¤œè¨¼ï¼ˆHaze=0ãƒ‡ãƒ¼ã‚¿ã§è¨“ç·´ã€Prediction + Surpriseè¨ˆç®—ï¼‰
- **Phase 4-5**: ç•°ãªã‚‹å›ºå®šHazeå€¤ï¼ˆ0.0, 0.3, 0.5, 0.7ï¼‰ã§ã®åˆ¶å¾¡çµ±åˆãƒ»æ¯”è¼ƒå®Ÿé¨“
- **Phase 6**: Self-Hazingã®ç ”ç©¶é–‹ç™º

## å­¦è¡“çš„æ„ç¾©

EPH v5.6ã¯ã€ç†è«–çš„å³å¯†æ€§ï¼ˆFEPæº–æ‹ ï¼‰ã¨å®Ÿè£…å¯èƒ½æ€§ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–ï¼‰ã‚’ä¸¡ç«‹ã•ã›ã€Freezing Robot Problemã¨ã„ã†å®Ÿç”¨çš„èª²é¡Œã«å¯¾ã™ã‚‹ç†è«–çš„è§£æ±ºç­–ã‚’æç¤ºã—ãŸã€‚

## ä»Šå¾Œã®å±•æœ›

Self-Hazingã«ã‚ˆã‚‹è‡ªå¾‹åŒ–ã€å®Ÿç’°å¢ƒå®Ÿé¨“ã€ç¾¤çŸ¥èƒ½ã¸ã®æ‹¡å¼µã«ã‚ˆã‚Šã€æœ¬ç ”ç©¶ã®å°„ç¨‹ã¯å˜ä½“ãƒ­ãƒœãƒƒãƒˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¶…ãˆã¦ã€åºƒç¯„ãªä¸ç¢ºå®Ÿæ€§é©å¿œå‹AIã‚·ã‚¹ãƒ†ãƒ ã¸ã¨æ‹¡å¤§ã™ã‚‹ã€‚

---

**è¬è¾ (Acknowledgments)**

æœ¬ç ”ç©¶ã¯ã€æ±äº¬é›»æ©Ÿå¤§å­¦ã®ç ”ç©¶ç’°å¢ƒãŠã‚ˆã³é–¢ä¿‚è€…ã®æ”¯æ´ã«ã‚ˆã‚Šå®Ÿæ–½ã•ã‚ŒãŸã€‚

---

**å‚è€ƒæ–‡çŒ® (References)**

1. Friston, K. (2010). The free-energy principle: a unified brain theory? *Nature Reviews Neuroscience*, 11(2), 127-138.

2. Friston, K., et al. (2015). Active inference and epistemic value. *Cognitive Neuroscience*, 6(4), 187-214.

3. Kendall, A., & Gal, Y. (2017). What uncertainties do we need in Bayesian deep learning for computer vision? *NeurIPS*.

4. Helbing, D., et al. (2000). Simulating dynamical features of escape panic. *Nature*, 407(6803), 487-490.

5. van den Berg, J., et al. (2011). Reciprocal n-body collision avoidance. *Robotics Research*, 3-19.

6. Chen, Y. F., et al. (2017). Socially aware motion planning with deep reinforcement learning. *IROS*.

7. Haarnoja, T., et al. (2018). Soft actor-critic algorithms and applications. *arXiv:1812.05905*.

---

**ä»˜éŒ² (Appendices)**

## ä»˜éŒ² A: Surpriseè¨ˆç®—ã®è©³ç´°

VAEå†æ§‹æˆèª¤å·®ã®è¨ˆç®—æ‰‹é †ï¼š

```julia
function compute_surprise(vae, spm, u)
    # 1. Reshape
    spm_input = Float32.(reshape(spm, 16, 16, 3, 1))
    u_input = Float32.(reshape(u, 2, 1))

    # 2. Encode
    Î¼, logÏƒ = encode(vae, spm_input, u_input)

    # 3. Use mean (deterministic)
    z = Î¼

    # 4. Decode
    spm_recon = decode_with_u(vae, z, u_input)

    # 5. MSE
    surprise = mean((spm_input .- spm_recon).^2)

    return Float64(surprise)
end
```

## ä»˜éŒ² B: Hazeå¤‰èª¿ã®æ•°ç†

Precisionå¤‰èª¿é–¢æ•°ã®å°å‡ºï¼š

$$
\beta(\text{Haze}) = \frac{\beta_{\max}}{1 + \alpha \cdot \text{Haze}}
$$

å¢ƒç•Œæ¡ä»¶:
- $\text{Haze} = 0$ â†’ $\beta = \beta_{\max}$ (æœ€é«˜ç²¾åº¦)
- $\text{Haze} = 1$ â†’ $\beta = \beta_{\max} / (1 + \alpha)$ (æœ€ä½ç²¾åº¦)

æ„Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\alpha$ ã®åŠ¹æœ:
- $\alpha$ å¤§ â†’ Hazeã®å½±éŸ¿ãŒå¼·ã„
- $\alpha$ å° â†’ Hazeã®å½±éŸ¿ãŒå¼±ã„

---

**END OF DOCUMENT**
