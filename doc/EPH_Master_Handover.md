# EPH (Emergent Perceptual Haze) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼šãƒãƒ³ãƒ‰ã‚ªãƒ¼ãƒãƒ¼è³‡æ–™

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç† (FEP) ã‚’ç”¨ã„ã¦ã€æ··é›‘ç’°å¢ƒã«ãŠã‘ã‚‹ãƒ­ãƒœãƒƒãƒˆã®ç«‹ã¡å¾€ç”Ÿ (Freezing) ã‚’è§£æ±ºã™ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ **EPH** ã‚’å®Ÿè£…ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚ä¸ç¢ºå®Ÿæ€§ã‚’ **Haze** (äºˆæ¸¬åˆ†æ•£) ã¨ã—ã¦å®šé‡åŒ–ã—ã€ãã‚ŒãŒçŸ¥è¦šè§£åƒåº¦ (Precision) ã‚’é©å¿œçš„ã«å¤‰èª¿ã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ (Technical Stack)

- **è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ (Backend)**: Julia 1.10+ (Apple Silicon M2 æœ€é©åŒ–)
    
    - è‡ªå‹•å¾®åˆ†: `ForwardDiff.jl` (è¡Œå‹•ç”Ÿæˆç”¨), `Zygote.jl` (VAEå­¦ç¿’ç”¨)
        
    - é€šä¿¡: `ZMQ.jl` (PUBãƒ¢ãƒ¼ãƒ‰, éåŒæœŸ 30-60Hz)
        
    - ãƒ‡ãƒ¼ã‚¿ä¿å­˜: `HDF5.jl` (HDF5å½¢å¼)
        
- **å¯è¦–åŒ– (Frontend)**: Python 3.10+
    
    - æç”»: `matplotlib` (Main Viewer & Detail Viewer ã®äºŒé‡æ§‹æˆ)
        
    - é€šä¿¡: `pyzmq`, `msgpack`
        
- **å®Ÿè¡Œç’°å¢ƒ**: Docker (Ubuntu 22.04)
    

## 3. æ•°ç†ãƒ»çŸ¥è¦šä»•æ§˜ (Mathematical Specs)

### 3.1 çŸ¥è¦šè¡¨ç¾: SPM (Saliency Polar Map)

- **è§£åƒåº¦**: $16 \times 16 \times 3$ ch (Occupancy, Saliency, Risk)
    
- **è¦–é‡è§’ (FOV)**: 210åº¦ (å‰æ–¹ä¸­å¿ƒ Â±105åº¦)
    
- **è·é›¢ã‚¹ã‚±ãƒ¼ãƒ«**: å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ« (Log-scale)
    
- **æ­£è¦åŒ–**: è¦–é‡è·é›¢ $D = 15 \times (r_{robot} + r_{agent})$ã€‚è¡¨é¢è·é›¢åŸºæº–ã§æ­£è¦åŒ–ã€‚
    
- **æŠ•å½±**: é ˜åŸŸæŠ•å½± (Blurred Projection / Gaussian kernel $\sigma \approx 0.25$)
    

### 3.2 åˆ¶å¾¡ãƒ»æ„æ€æ±ºå®š

- **æ‰‹æ³•**: Active Inference (èƒ½å‹•çš„æ¨è«–)
    
- **ç›®çš„é–¢æ•°**: å¤‰åˆ†è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ (VFE) $F$  
    
- **ã‚´ãƒ¼ãƒ«å®šç¾©**: **Prior Preference** $P(y)$ ã«ã‚ˆã‚‹ãƒ¡ã‚¿è©•ä¾¡ã€‚æŒ‡å®šæ–¹å‘ï¼ˆN, S, E, Wï¼‰ã«éšœå®³ç‰©ãŒãªãæµå‹•ãŒã‚ã‚‹çŠ¶æ…‹ã‚’ã€ŒæœŸå¾…ã€ã™ã‚‹ã€‚
    
- **åˆ¶ç´„**: è¡Œå‹• $u$ ã«å¯¾ã™ã‚‹ `clamp(u, -u_max, u_max)` å‡¦ç†ã€‚
    

## 4. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«

### 4.1 ZMQ PUB/SUB ãƒ‘ã‚±ãƒƒãƒˆ (MsgPack)

- `global`: å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç›¸å¯¾ä½ç½®ã€ã‚°ãƒ«ãƒ¼ãƒ—IDï¼ˆè‰²åˆ†ã‘ç”¨ï¼šN:Blue, S:Red, E:Green, W:Yellowï¼‰
    
- `detail`: é¸æŠã•ã‚ŒãŸ1å°ã® SPM(3ch), VFE, Haze, Precision, è¡Œå‹• $u$  
    

### 4.2 HDF5 ä¿å­˜ã‚¹ã‚­ãƒ¼ãƒ

- `/data/spm`: Float32 [16, 16, 3, Steps]
    
- `/data/action`: Float32 [2, Steps]
    
- `/data/haze`: Float32 [Steps]
    

## 5. é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— (Milestones)

1. **M1-A (Julia)**: âœ… 4ã‚°ãƒ«ãƒ¼ãƒ—ã®æ±è¥¿å—åŒ—ãƒ•ãƒ­ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã€SPMç”Ÿæˆã€ZMQé…ä¿¡ã®å®Ÿè£…ã€‚
    
2. **M1-B (Python)**: âœ… ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ï¼ˆè‰²åˆ†ã‘ï¼‰ã¨è©³ç´°ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ï¼ˆSPM/ã‚°ãƒ©ãƒ•ï¼‰ã®å®Ÿè£…ã€‚
    
3. **M2 (Julia/Flux)**: âœ… 16x16å¯¾å¿œ VAE ã®å®šç¾©ã¨ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸ Haze æ¨å®šã®è¨“ç·´ã€‚
    
4. **M3 (Integration)**: âœ… Haze ã«ã‚ˆã‚‹ Î² å¤‰èª¿ã‚’çµ„ã¿è¾¼ã‚“ã å®Œå…¨ãª EPH ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®æ¤œè¨¼ã€‚
   - âœ… Freezingæ¤œå‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
   - âœ… è©•ä¾¡ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆSuccess Rate, Collision Rate, Jerk, TTCï¼‰
   - âœ… ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒ‡ã‚£ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆA1-A4æ¡ä»¶ï¼‰
   - âœ… çµ±è¨ˆè§£æãƒ„ãƒ¼ãƒ«ï¼ˆç›®æ¨™é”æˆç¢ºèªï¼šFreezing 36%æ¸›ã€Jerk 23%æ”¹å–„ï¼‰

5. **M4 (Future Enhancements)**: ğŸ”„ è¨ˆç”»ä¸­
   - ğŸ¯ **äºˆæ¸¬çš„è¡çªå›é¿**: Expected Free Energy (EFE) æœ€å°åŒ–
   - ğŸ¯ **Ch3ä¸­å¿ƒè©•ä¾¡**: å‹•çš„è¡çªãƒªã‚¹ã‚¯äºˆæ¸¬ï¼ˆTTC-basedï¼‰
   - å®Ÿé¨“å®Ÿè¡Œã¨è«–æ–‡æŠ•ç¨¿æº–å‚™
   - å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«ã®å¼·åŒ–


## 6. æ¬¡ã®AIã¸ã®æŒ‡ç¤º (Next Step Prompt)

> ã€Œã‚ãªãŸã¯ Julia ã¨ Python ã®ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨ã—ã¦ EPH ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å¼•ãç¶™ãã¾ã™ã€‚
> 
> **ç¾åœ¨ã®çŠ¶æ…‹**: M3ï¼ˆæ¤œè¨¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼‰ã¾ã§å®Œäº†ã€‚å…¨ãƒ„ãƒ¼ãƒ«ãŒå®Ÿè£…æ¸ˆã¿ã€‚
> 
> **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆM4ï¼‰**: äºˆæ¸¬çš„è¡çªå›é¿ã®å®Ÿè£…
> 1. äºˆæ¸¬SPMç”Ÿæˆæ©Ÿèƒ½ã®è¿½åŠ 
> 2. Expected Free Energy (EFE) ã®å®šå¼åŒ–
> 3. Ch3ï¼ˆå‹•çš„è¡çªãƒªã‚¹ã‚¯ï¼‰ä¸­å¿ƒã®è©•ä¾¡é–¢æ•°
> 4. è‡ªå‹•å¾®åˆ†ã«ã‚ˆã‚‹å‹¾é…è¨ˆç®—ã¨æœ€é©åŒ–
> 
> è©³ç´°ã¯ `predictive_collision_avoidance_discussion.md` ãŠã‚ˆã³ `ch3_focused_evaluation.md` ã‚’å‚ç…§ã€‚ã€

ä½œæˆè€…: Gemini (AI-DLC Navigator)

ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ãƒãƒ³ãƒ‰ã‚ªãƒ¼ãƒãƒ¼æº–å‚™å®Œäº†