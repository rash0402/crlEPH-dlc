# EPH (Emergent Perceptual Haze) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼åŸç†ï¼ˆFree Energy Principleï¼‰ã«åŸºã¥ãã€æ··é›‘ç’°å¢ƒã«ãŠã‘ã‚‹ç¤¾ä¼šçš„ãƒ­ãƒœãƒƒãƒˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®ç ”ç©¶å®Ÿè£…ã§ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**EPHï¼ˆEmergent Perceptual Hazeï¼‰** ã¯ã€ä¸ç¢ºå®Ÿæ€§ã‚’**çŸ¥è¦šè§£åƒåº¦ï¼ˆPerceptual Precisionï¼‰**ã®å¯å¤‰è¨­è¨ˆã¨ã—ã¦æ‰±ã†Active Inferenceã®å·¥å­¦çš„æ‹¡å¼µã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã™ã€‚äºˆæ¸¬ä¿¡é ¼æ€§ã«å¿œã˜ã¦çŸ¥è¦šãƒ»æ³¨æ„ã®é‹­ã•ã‚’é€£ç¶šçš„ã«å¤‰èª¿ã™ã‚‹ã“ã¨ã§ã€å˜ä½“ãƒ­ãƒœãƒƒãƒˆãŠã‚ˆã³ç¾¤çŸ¥èƒ½ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹åœæ­¢ï¼ˆFreezingï¼‰ãƒ»æŒ¯å‹•ãƒ»åˆ†æ–­ã¨ã„ã£ãŸä¸ç¢ºå®Ÿæ€§èµ·å› ã®è¡Œå‹•ç ´ç¶»ã‚’æ§‹é€ çš„ã«æŠ‘åˆ¶ã—ã¾ã™ã€‚

### ä¸»è¦æ¦‚å¿µ
- **SPM (Saliency Polar Map)**: éœŠé•·é¡V1é‡ã‚’æ¨¡å€£ã—ãŸå¯¾æ•°æ¥µåº§æ¨™ã®ç”Ÿä½“æ¨¡å€£çš„çŸ¥è¦šè¡¨ç¾
- **Haze**: ä¸ç¢ºå®Ÿæ€§ã‚’å®šé‡åŒ–ã—ã€çŸ¥è¦šè§£åƒåº¦ã®åˆ¶å¾¡ã«å†™åƒã™ã‚‹æ“ä½œçš„æŒ‡æ¨™ $H(y,u)$
- **Pattern D Integration**: è¡Œå‹•ä¾å­˜ã®ä¸ç¢ºå®Ÿæ€§ï¼ˆCounterfactual Hazeï¼‰ã‚’æ¨å®šã™ã‚‹VAEãƒ¢ãƒ‡ãƒ«
- **4ç¾¤ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®**: æ¨™æº–çš„ãªãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªï¼ˆN/S/E/Wç¾¤ãŒä¸­å¤®ã§äº¤å·®ï¼‰

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
crlEPH-dlc/
â”œâ”€â”€ doc/                          # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ç ”ç©¶ææ¡ˆæ›¸
â”œâ”€â”€ src/                          # Juliaãƒ¡ã‚¤ãƒ³å®Ÿè£…
â”‚   â”œâ”€â”€ config.jl                 # ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
â”‚   â”œâ”€â”€ spm.jl                    # SPMç”Ÿæˆï¼ˆ16x16x3ch: å æœ‰ãƒ»é¡•è‘—æ€§ãƒ»ãƒªã‚¹ã‚¯ï¼‰
â”‚   â”œâ”€â”€ dynamics.jl               # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç‰©ç†æ¼”ç®—
â”‚   â”œâ”€â”€ controller.jl             # FEPãƒ™ãƒ¼ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©
â”‚   â”œâ”€â”€ action_vae.jl             # Action-Dependent VAE (Pattern D)
â”‚   â”œâ”€â”€ communication.jl          # ZMQé€šä¿¡
â”‚   â”œâ”€â”€ metrics.jl                # è©•ä¾¡æŒ‡æ¨™ãƒ»Freezingåˆ¤å®š
â”‚   â””â”€â”€ logger.jl                 # HDF5ãƒ­ã‚®ãƒ³ã‚°
â”œâ”€â”€ scripts/                      # å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ run_all.sh                # [æ¨å¥¨] ä¸€æ‹¬èµ·å‹•ãƒ©ãƒ³ãƒãƒ£ãƒ¼
â”‚   â”œâ”€â”€ run_simulation.jl         # ãƒ¡ã‚¤ãƒ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ train_action_vae.jl       # VAEå­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ validate_haze.jl          # Hazeå¦¥å½“æ€§æ¤œè¨¼
â”‚   â”œâ”€â”€ evaluate_metrics.jl       # è©•ä¾¡æŒ‡æ¨™è¨ˆç®—
â”‚   â””â”€â”€ archive/                  # æ—§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é€€é¿å ´æ‰€
â”œâ”€â”€ viewer/                       # Pythonå¯è¦–åŒ–
â”‚   â”œâ”€â”€ zmq_client.py             # ZMQã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ
â”‚   â”œâ”€â”€ main_viewer.py            # 4ç¾¤è¡¨ç¤º
â”‚   â””â”€â”€ detail_viewer.py          # SPMè©³ç´°ãƒ“ãƒ¥ãƒ¼
â”œâ”€â”€ Project.toml                  # Juliaä¾å­˜é–¢ä¿‚
â”œâ”€â”€ requirements.txt              # Pythonä¾å­˜é–¢ä¿‚
â””â”€â”€ CLAUDE.md                     # Claude Codeå‘ã‘é–‹ç™ºã‚¬ã‚¤ãƒ‰
```

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

**Julia** (1.10+):
```bash
julia --project=. -e 'using Pkg; Pkg.instantiate()'
```

**Python** (3.10+):
```bash
~/local/venv/bin/pip install -r requirements.txt
```

### 2. ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

**æ¨å¥¨: ä¸€æ‹¬èµ·å‹• (Mac/Linux)**
```bash
./scripts/run_all.sh
```
ã“ã‚Œã«ã‚ˆã‚Šã€Juliaãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨Pythonãƒ“ãƒ¥ãƒ¼ã‚¢ãŒèµ·å‹•ã—ã¾ã™ã€‚

**æ‰‹å‹•èµ·å‹•**
```bash
# Terminal 1: Simulation
julia --project=. scripts/run_simulation.jl

# Terminal 2: Viewer
~/local/venv/bin/python viewer/detail_viewer.py
```

### 3. VAEå­¦ç¿’ã¨æ¤œè¨¼

**å­¦ç¿’**
```bash
julia --project=. scripts/train_action_vae.jl
```

**Haze å¦¥å½“æ€§æ¤œè¨¼ (Pattern D)**
```bash
julia --project=. scripts/validate_haze.jl
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (v5.5 Pattern D)

æœ¬å®Ÿè£…ã¯ **Action-Dependent Uncertainty (Pattern D)** ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

### Juliaãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (`src/`)
- **action_vae.jl**: $(y_t, u_t)$ ã‚’å…¥åŠ›ã¨ã™ã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã‚’æŒã¡ã€åäº‹å®Ÿçš„ãªä¸ç¢ºå®Ÿæ€§ï¼ˆCounterfactual Hazeï¼‰ã‚’æ¨å®šã—ã¾ã™ã€‚
- **controller.jl**: æ¨å®šã•ã‚ŒãŸ Haze ã‚’ç”¨ã„ã¦ã€è‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼æœ€å°åŒ–ã«ãŠã‘ã‚‹çŸ¥è¦šè§£åƒåº¦ $\beta$ ã‚’é©å¿œçš„ã«å¤‰èª¿ã—ã¾ã™ã€‚

### ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›
- **Simulation Logs**: `data/logs/` (HDF5å½¢å¼)
- **VAE Training Data**: `data/vae_training/`
- **Validation Results**: `results/haze_validation/`

## æ©Ÿèƒ½

### Phase 1.5: Pattern D å®Ÿè£… (å®Œäº†) âœ…
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: Action-Dependent Encoder ($q(z|y, u)$)
- **Hazeå®šç¾©**: $H(y, u) = \text{Agg}(\sigma_z^2(y, u))$
- **æ¤œè¨¼**: è¡Œå‹•ã«ã‚ˆã‚‹ä¸ç¢ºå®Ÿæ€§ã®å¤‰åŒ–ã‚’ç¢ºèªæ¸ˆã¿

### Phase 2: è©•ä¾¡æŒ‡æ¨™ (é€²è¡Œä¸­) ğŸš§
- **Freezing Rate**: åœæ­¢çŠ¶æ…‹ã®å®šé‡çš„æ¤œå‡º
- **Collision Rate**: è¡çªé »åº¦ã®æ¸¬å®š
- **Jerk**: å‹•ä½œã®æ»‘ã‚‰ã‹ã•ã®è©•ä¾¡

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ç ”ç©¶ç›®çš„ã§é–‹ç™ºã•ã‚Œã¦ã„ã¾ã™ã€‚

## è‘—è€…

äº”ååµ æ´‹ï¼ˆHiroshi Igarashiï¼‰
æ±äº¬é›»æ©Ÿå¤§å­¦
