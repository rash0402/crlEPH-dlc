# V7.2 Raw Trajectory Viewer

**5DçŠ¶æ…‹ç©ºé–“ï¼ˆx, y, vx, vy, Î¸ï¼‰å¯¾å¿œã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è»Œè·¡ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼**

## ä½¿ç”¨æ–¹æ³•

### æ±ç”¨ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆçµŒç”±ï¼ˆæ¨å¥¨ï¼‰

```bash
# GUIãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°
./scripts/view_data.sh

# ãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®š
./scripts/view_data.sh data/vae_training/raw_v72/v72_scramble_d10_s1_*.h5
```

### ç›´æ¥Pythonå®Ÿè¡Œ

```bash
# GUIãƒ€ã‚¤ã‚¢ãƒ­ã‚°
~/local/venv/bin/python viewer/v72/raw_viewer.py

# ãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®š
~/local/venv/bin/python viewer/v72/raw_viewer.py data/vae_training/raw_v72/v72_scramble_d10_s1_*.h5
```

---

## v7.2ã®ä¸»è¦æ©Ÿèƒ½

### ã‚³ã‚¢æ©Ÿèƒ½
- **5DçŠ¶æ…‹ç©ºé–“**: ä½ç½®ï¼ˆx, yï¼‰ã€é€Ÿåº¦ï¼ˆvx, vyï¼‰ã€å§¿å‹¢ï¼ˆÎ¸ï¼‰
- **HeadingçŸ¢å°**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‘ãï¼ˆé»’çŸ¢å°ï¼‰ã‚’è¡¨ç¤º
- **ç›®æ¨™æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«**: d_goalï¼ˆç´«ã®ç ´ç·šçŸ¢å°ï¼‰
- **Heading vs é€Ÿåº¦æ–¹å‘**: æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ
- **å…¨æ–¹å‘åŠ›åˆ¶å¾¡**: [Fx, Fy]ã®å±¥æ­´è¡¨ç¤º
- **v7.2ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**: m=70kg, u_max=150N, k_align=4.0 rad/s

### å¯è¦–åŒ–æ©Ÿèƒ½ï¼ˆv6.3ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
- **Local View**: é¸æŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¦–ç•Œï¼ˆSensing Range + FOVè¡¨ç¤ºï¼‰
- **SPM 3ãƒãƒ£ãƒ³ãƒãƒ«**: Occupancy, Proximity, Collision Risk
- **SPM Info ãƒ‘ãƒãƒ«**: é¸æŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®SPMçµ±è¨ˆ
- **4Ã—4ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: v6.3ã¨åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

---

## ç”»é¢æ§‹æˆï¼ˆ4Ã—4ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Global View    â”‚  Local View     â”‚  Row 0-1 (å¤§ãƒ‘ãƒãƒ« 2Ã—2)
â”‚  (å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ) â”‚  (é¸æŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ) â”‚
â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚SPM  â”‚SPM  â”‚SPM  â”‚ SPM Info        â”‚  Row 2 (SPMãƒãƒ£ãƒ³ãƒãƒ«)
â”‚Ch1  â”‚Ch2  â”‚Ch3  â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Head-â”‚Cont-â”‚Coll-â”‚ Statistics      â”‚  Row 3 (æ™‚ç³»åˆ—ï¼‹çµ±è¨ˆ)
â”‚ing  â”‚rol  â”‚isionâ”‚                 â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Row 0-1: ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼

- **Global View** (å·¦ä¸Š, 2Ã—2): å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€è»Œè·¡ã€HeadingçŸ¢å°ã€ç›®æ¨™æ–¹å‘
- **Local View** (å³ä¸Š, 2Ã—2): é¸æŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸­å¿ƒã€Sensing Rangeã€FOV

### Row 2: SPMå¯è¦–åŒ–

- **SPM 3ãƒãƒ£ãƒ³ãƒãƒ«**: Occupancy (Gray), Proximity (Hot), Collision Risk (Reds)
- **SPM Info**: é¸æŠã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®SPMçµ±è¨ˆ

### Row 3: æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆï¼‹çµ±è¨ˆ

- **Heading Alignment**: Heading Î¸ vs é€Ÿåº¦æ–¹å‘ã®æ™‚ç³»åˆ—
- **Control Forces**: Fx, Fy, |F|ã®å±¥æ­´
- **Collision Events**: è¡çªã‚¤ãƒ™ãƒ³ãƒˆæ™‚ç©ºé–“åˆ†å¸ƒ
- **Statistics**: ã‚·ãƒŠãƒªã‚ªæƒ…å ±ã€ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€è¡çªçµ±è¨ˆ

---

## æ“ä½œæ–¹æ³•

### ãƒã‚¦ã‚¹æ“ä½œ
- **å·¦ã‚¯ãƒªãƒƒã‚¯ï¼ˆGlobal Viewï¼‰**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¸æŠï¼ˆ2mä»¥å†…ï¼‰

### ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«
- **Time Step Slider**: ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—å¤‰æ›´
- **Play/Pause**: è‡ªå‹•å†ç”Ÿ
- **Reset**: æœ€åˆã®ãƒ•ãƒ¬ãƒ¼ãƒ ã«ãƒªã‚»ãƒƒãƒˆ
- **Open File**: æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã

---

## v7.2ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```
/trajectory/
  â”œâ”€ pos      [T, N, 2]  # Position (x, y)
  â”œâ”€ vel      [T, N, 2]  # Velocity (vx, vy)
  â”œâ”€ heading  [T, N]     # Heading Î¸
  â”œâ”€ u        [T, N, 2]  # Control (Fx, Fy)
  â”œâ”€ d_goal   [N, 2]     # Direction vectors
  â””â”€ group    [N]        # Group ID

/events/
  â”œâ”€ collision        [T, N]
  â””â”€ near_collision   [T, N]

/obstacles/              # For random_obstacles
  â”œâ”€ centers  [M, 2]
  â””â”€ radii    [M]

/metadata/
  â”œâ”€ scenario         str
  â”œâ”€ version          str
  â”œâ”€ collision_rate   float

/v72_params/
  â”œâ”€ mass             float  # 70.0 kg
  â”œâ”€ k_align          float  # 4.0 rad/s
  â””â”€ u_max            float  # 150.0 N
```

---

## ç¢ºèªãƒã‚¤ãƒ³ãƒˆ

1. **Heading Alignment**: Heading Î¸ ãŒé€Ÿåº¦æ–¹å‘ã«è¿½å¾“ï¼ˆÏ„ â‰ˆ 0.25sï¼‰
2. **ç›®æ¨™æ–¹å‘ã¸ã®é€²æ—**: Progress = vÂ·d_goal > 0
3. **è¡çªãƒ‘ã‚¿ãƒ¼ãƒ³**: Collision Eventsã§æ™‚ç©ºé–“åˆ†å¸ƒã‚’ç¢ºèª
4. **åˆ¶å¾¡åŠ›ã®ç‰¹æ€§**: Fx, FyãŒç‹¬ç«‹ã«å¤‰åŒ–ï¼ˆå…¨æ–¹å‘æ€§ï¼‰

---

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- **ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ**: `scripts/view_data.sh`
- **ãƒ‡ãƒ¼ã‚¿åé›†**: `scripts/v72/dataset/*.jl`
- **ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: `data/vae_training/raw_v72/`
- **v7.2å®Ÿè£…**: `src/dynamics.jl`, `src/config.jl`, `src/controller.jl`

---

**v7.2ã®Heading Alignment Dynamicsã®åŠ¹æœã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼** ğŸ¯
